<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../helpproject.xsl" ?>
<topic template="Default" modified="2024-06-15T19:06:32.661+08:00" lasteditedby="Design" version="2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../helpproject.xsd">
  <title>FUNCTION Statement</title>
  <keywords>
    <keyword>Compiledeclaration</keyword>
    <keyword>Declaration statements</keyword>
    <keyword>Entity declaration</keyword>
    <keyword>FUNCTION</keyword>
    <keyword>FUNCTION statement</keyword>
    <keyword>Statements</keyword>
    <keyword>STATIC FUNCTION statement</keyword>
    <keyword>Strong typing<keyword>defined</keyword></keyword>
  </keywords>
  <body>
    <header>
      <para styleclass="Heading1">FUNCTION Statement</para>
    </header>
    <para styleclass="Heading1">用途</para>
    <para styleclass="Normal">向编译器声明一个函数名和一个可选的局部变量名列表。在 FoxPro DEFINE CLASS ... ENDDEFINE 中使用时，将声明一个方法。</para>
    <para styleclass="Heading1">语法</para>
    <para styleclass="Normal"><tab />[Attributes] [Modifiers] <text style="font-weight:bold;">FUNCTION</text> &lt;<text styleclass="Italic">idFunction</text>&gt; </para>
    <para styleclass="Normal"><tab />[Typeparameters]</para>
    <para styleclass="Normal"><tab />[([&lt;<text styleclass="Italic">idParam</text>&gt; [AS | REF|OUT|IN &lt;<text styleclass="Italic">idType</text>&gt;] [, ...])] </para>
    <para styleclass="Normal"><tab />[AS &lt;<text styleclass="Italic">idType</text>&gt;]</para>
    <para styleclass="Normal"><tab />[TypeparameterConstraints]</para>
    <para styleclass="Normal"><tab />[&lt;<text styleclass="Italic">idConvention</text>&gt;]</para>
    <para styleclass="Normal"><tab />[EXPORT LOCAL] </para>
    <para styleclass="Normal"><tab />[DLLEXPORT STRING_CONST]</para>
    <para styleclass="Normal"><tab />[=&gt; &lt;expression&gt;]</para>
    <para styleclass="Normal"><tab /><text style="font-weight:bold;">CRLF</text></para>
    <para styleclass="Normal"><tab />[&lt;<text styleclass="Italic">Body</text>&gt;]</para>
    <para styleclass="Normal"><tab />[ENDFUNC | END FUNCTION]</para>
    <para styleclass="Heading1">参数</para>
    <para styleclass="Heading1"><snippet src="__IncludeAttributes" inline="false"/></para>
    <para styleclass="List"><snippet src="__IncludeFuncProcModifiers" inline="false"/></para>
    <para styleclass="List"><tab />请注意，在 FoxPro 兼容类中作为类成员使用的函数和过程可以有更多的修饰符。</para>
    <para styleclass="List"></para>
    <para styleclass="List">&lt;idFunction&gt;<tab />函数的有效标识符名称。 函数是一个实体，因此与其他实体共享相同的名称空间。 这意味着不可能出现函数和类同名的情况。</para>
    <para styleclass="List"><snippet src="__IncludeFunctionParameters" inline="false"/></para>
    <para styleclass="List"><snippet src="__IncludeExpressionBody" inline="false"/></para>
    <para styleclass="List"><snippet src="__IncludeBody" inline="false"/></para>
    <para styleclass="List"></para>
    <para styleclass="List">ENDFUNC | END FUNCTION<tab />这些(可选)关键字表示函数的逻辑终点。</para>
    <para styleclass="Heading1">描述</para>
    <para styleclass="Normal">函数是一个子程序，由一系列声明和语句组成，每当提及 &lt;idFunction&gt; 时都要执行(见下面的备注部分)。</para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal">函数和过程(参见本指南中的 PROCEDURE 语句)是基本的过程编程单元。 您将在应用程序中使用它们来组织计算代码块。</para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal">通过 STATIC FUNCTION(静态函数)，您可以将函数名称的可见性限制在当前模块内，从而限制对函数的访问。 在设计模块时，如果模块中包含一些公共例程(即在整个应用程序中可见)，而其他一些例程则完全属于支持例程(即只有同一模块中的其他例程才需要)，那么该功能就非常有用。</para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal">只需使用 STATIC FUNCTION 声明所有支持函数即可。 这样做有两个立竿见影的好处。 首先，应用程序中的其他模块不会无意中调用你的支持例程。 其次，由于静态引用是在编译时解析的，而公共引用是在链接时解析的，因此不会出现名称冲突。 例如，如果在模块 X 中声明了一个静态 Service() 函数，而在模块 Y 中声明了一个公共 Service() 函数，那么在 X 中对 Service() 的所有引用都将执行静态版本，而应用程序中对 Service() 的所有其他引用都将执行公共版本。</para>
    <para styleclass="Heading1">备注</para>
    <para styleclass="Normal"><text styleclass="BoldItalic" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-decoration:none; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">Start() 函数： &#160;所有应用程序都必须有一个名为 Start() 的函数或过程，或者与图形用户界面类库链接，并有一个 CLASS App 方法 Start()。 Start()是应用程序执行时的启动例程。 Start() 不能声明任何参数，在正常情况下也不应返回值。 如果要在声明语句中使用</text><link displaytype="text" defaultstyle="true" type="topiclink" href="Strong-Typing">强类型</link><text styleclass="BoldItalic" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-decoration:none; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">，则必须指定 AS USUAL PASCAL。</text></para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal"><text styleclass="BoldItalic" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-decoration:none; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">通过代码块输出本地语言 &#160;创建代码块时，可以在代码块定义中访问创建实体中定义的局部变量，而无需将它们作为参数传递(即局部变量对代码块是可见的)。 利用这一事实以及可以将代码块作为参数传递的事实，就可以导出局部变量。 例如</text>：</para>
    <para styleclass="Code Example"><text style="font-weight:bold; font-style:normal; color:#ff0000;">FUNCTION</text><text style="font-weight:bold; font-style:normal; color:#000000;"> One</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">()</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">EXPORT</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">LOCAL</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#ff0000;">LOCAL</text><text style="font-weight:bold; font-style:normal; color:#000000;"> nVar </text><text style="font-weight:bold; font-style:normal; color:#0000ff;">:=</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">10</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">AS</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">INT</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">,</text><text style="font-weight:bold; font-style:normal; color:#000000;"> cbAdd </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">AS</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">CODEBLOCK</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#000000;">cbAdd </text><text style="font-weight:bold; font-style:normal; color:#0000ff;">:=</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">{</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">|</text><text style="font-weight:bold; font-style:normal; color:#000000;">nValue</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">|</text><text style="font-weight:bold; font-style:normal; color:#000000;"> nValue </text><text style="font-weight:bold; font-style:normal; color:#0000ff;">+</text><text style="font-weight:bold; font-style:normal; color:#000000;"> nVar</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">}</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#0000ff;">?</text><text style="font-weight:bold; font-style:normal; color:#000000;"> NextFunc</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">(</text><text style="font-weight:bold; font-style:normal; color:#000000;">cbAdd</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">)</text><tab /><tab /><tab /><text style="font-weight:bold; font-style:normal; color:#ff00ff;">// Result: &#160;210</text><br/><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">FUNCTION</text><text style="font-weight:bold; font-style:normal; color:#000000;"> NextFunc</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">(</text><text style="font-weight:bold; font-style:normal; color:#000000;">cbAddEmUp</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">)</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#ff0000;">RETURN</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">(</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">EVAL</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">(</text><text style="font-weight:bold; font-style:normal; color:#000000;">cbAddEmUp</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">,</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">200))</text></para>
    <para styleclass="Normal">在 NextFunc() 中对代码块进行求值时，函数 One() 的本地 nVar 变为可见，尽管它没有直接作为参数传递。</para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal">调用函数：调用函数的语法如下：</para>
    <para styleclass="Code Example">&lt;idFunction&gt;([&lt;uArgList&gt;])</para>
    <para styleclass="Normal">其中 &lt;uArgList&gt; 是一个可选的逗号分隔参数列表，用于将参数传递给指定函数。 函数使用作为函数声明一部分指定的参数变量，按传递的顺序接收参数。</para>
    <para styleclass="Normal">请注意，如果函数没有参数，则 FUNCTION 语句中不需要使用括号，但在调用时始终需要使用括号。</para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal">可以在表达式中调用函数，也可以作为程序语句调用函数。 如果作为程序语句调用，返回值将被忽略。</para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal">也可以以别名表达式的形式调用函数，例如：</para>
    <para styleclass="Code Example">&lt;idAlias&gt;-&gt;&lt;idFunction&gt;([&lt;uArgList&gt;])</para>
    <para styleclass="Normal">执行此操作后，与 &lt;idAlias&gt; 关联的工作区将被选中，函数将被执行，原始工作区将被重新选中。 您可以将别名表达式指定为程序语句，就像指定其他表达式一样。</para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal">函数可以递归调用自身。 这意味着您可以在函数的 &lt;FunctionBody&gt; 中引用函数。</para>
    <para styleclass="Normal">调用函数的具体方式取决于您在声明函数时指定(显式或隐式)的调用约定（&lt;idConvention&gt;）。</para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal">CLIPPER 调用约定： &#160;如果您声明的函数在参数列表中不包含任何数据类型，则函数默认使用 CLIPPER 调用约定。 您也可以在 FUNCTION 声明语句中指定 CLIPPER 调用约定，前提是不在参数列表中使用强类型。</para>
    <para styleclass="Normal">虽然 CLIPPER 调用约定不允许强类型参数，但它支持函数返回值的强类型。</para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal">使用 CLIPPER 调用约定，为函数声明的参数数不必与调用函数时传递的参数数一致。 您可以跳过任何参数，方法是将其从列表中删除(指定两个连续的逗号)或从列表末尾省略。 例如</para>
    <para styleclass="Normal"></para>
    <para styleclass="Code Example"><text style="font-weight:bold; font-style:normal; color:#ff0000;">FUNCTION</text><text style="font-weight:bold; font-style:normal; color:#000000;"> Start</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">()</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#000000;">MyFunc</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">(1,,</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">3)</text><tab /><text style="font-weight:bold; font-style:normal; color:#ff00ff;">// 省略第二个参数</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#000000;">MyFunc</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">(1,</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">2)</text><tab /><tab /><text style="font-weight:bold; font-style:normal; color:#ff00ff;">// 省略最后一个参数</text><br/><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">FUNCTION</text><text style="font-weight:bold; font-style:normal; color:#000000;"> MyFunc</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">(</text><text style="font-weight:bold; font-style:normal; color:#000000;">x</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">,</text><text style="font-weight:bold; font-style:normal; color:#000000;"> y</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">,</text><text style="font-weight:bold; font-style:normal; color:#000000;"> z</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">)</text></para>
    <para styleclass="Normal"><tab /><text styleclass="Code Example">...</text></para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal">一个未接收值的参数会被函数自动初始化为NIL，以便您可以检查是否有省略的参数。您可以使用 PCount() 来帮助确定传递的参数数量 — 该函数返回传递的最后一个参数的位置。</para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal">在 CLIPPER 函数中指定的任何参数都可以接收按值或引用传递的参数 — 语义是在调用函数时确定的，而不是在声明时确定的。表达式和变量的默认方法是按值传递。除了字段变量，当使用引用运算符(@)作为前缀时，所有变量都是按引用传递的。字段变量不能按引用传递，始终按值传递。</para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal">STRICT 调用约定：如果在参数列表中声明了任何数据类型，函数默认使用 STRICT 调用约定。您还可以在 FUNCTION 声明语句中指定STRICT调用约定。</para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal">使用 STRICT 调用约定，通过对函数的参数和返回值进行强类型化并声明函数的传递语义，您放弃了 CLIPPER 调用约定允许的许多功能，但在编译速度、应用程序完整性和执行速度方面获得了优势。</para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal">STRICT 函数不支持可变数量的参数、PCount() 或在宏表达式中使用的能力。</para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal">与 CLIPPER 函数类似，STRICT 函数允许在调用函数时确定调用语义，但仅适用于多态参数(即未强类型化的参数)。当参数被类型化时，调用语义也根据您使用 AS 或 REF 关键字而声明。AS 表示参数必须按值传递，REF 表示参数必须按引用传递(使用引用运算符(@))。</para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal">PASCAL调用约定：要指定此调用约定，请在 FUNCTION 声明语句中使用 PASCAL 作为最后一个关键字。从语法上讲，PASCAL 调用约定与 STRICT 相同，使用限制也相同，但在内部处理方式上有所不同。它与 Microsoft Pascal 调用约定相同，主要用于与 Windows 进行低级接口交互。</para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal">CALLBACK 调用约定：要指定此调用约定，请在 FUNCTION 声明语句中使用 CALLBACK 作为最后一个关键字。这是一种带有 Windows 序言和尾声的特殊 PASCAL 调用约定。它用于与 Windows 进行低级接口交互。</para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal">参数：作为在 FUNCTION 声明语句中指定参数的替代方法，您可以使用 PARAMETERS 语句来指定它们。然而，这种做法并不推荐，因为它效率较低，并且不提供编译时完整性验证。有关更多信息，请参阅本指南中的 PARAMETERS 语句。</para>
    <para styleclass="Heading1">示例</para>
    <para styleclass="Normal">本例演示了一个将数值格式化为货币的函数：</para>
    <para styleclass="Code Example"><text style="font-weight:bold; font-style:normal; color:#ff0000;">FUNCTION</text><text style="font-weight:bold; font-style:normal; color:#000000;"> Start</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">()</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#0000ff;">?</text><text style="font-weight:bold; font-style:normal; color:#000000;"> Currency</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">(1000)</text><tab /><tab /><text style="font-weight:bold; font-style:normal; color:#ff00ff;">// Result: &#160;$1,000.00</text><br/><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">FUNCTION</text><text style="font-weight:bold; font-style:normal; color:#000000;"> Currency</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">(</text><text style="font-weight:bold; font-style:normal; color:#000000;">nNum</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">)</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#ff0000;">LOCAL</text><text style="font-weight:bold; font-style:normal; color:#000000;"> cNum</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#ff0000;">IF</text><text style="font-weight:bold; font-style:normal; color:#000000;"> nNum &lt; </text><text style="font-weight:bold; font-style:normal; color:#0000ff;">0</text><br/><tab /><tab /><text style="font-weight:bold; font-style:normal; color:#000000;">cNum </text><text style="font-weight:bold; font-style:normal; color:#0000ff;">:=</text><text style="font-weight:bold; font-style:normal; color:#000000;"> Transform</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">(-1</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">*</text><text style="font-weight:bold; font-style:normal; color:#000000;"> nNum</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">,</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">;</text><br/><tab /><tab /><tab /><text style="font-weight:bold; font-style:normal; color:#0000ff;">&quot;999,999,999,999.99&quot;)</text><br/><tab /><tab /><text style="font-weight:bold; font-style:normal; color:#000000;">cNum </text><text style="font-weight:bold; font-style:normal; color:#0000ff;">:=</text><text style="font-weight:bold; font-style:normal; color:#000000;"> PadL</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">(&quot;($&quot;</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">+</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">LTRIM</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">(</text><text style="font-weight:bold; font-style:normal; color:#000000;">cNum</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">)+</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">&quot;)&quot;,</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">;</text><br/><tab /><tab /><tab /><text style="font-weight:bold; font-style:normal; color:#ff0000;">LEN</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">(</text><text style="font-weight:bold; font-style:normal; color:#000000;">cNum</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">))</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#ff0000;">ELSE</text><br/><tab /><tab /><text style="font-weight:bold; font-style:normal; color:#000000;">cNum </text><text style="font-weight:bold; font-style:normal; color:#0000ff;">:=</text><text style="font-weight:bold; font-style:normal; color:#000000;"> Transform</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">(</text><text style="font-weight:bold; font-style:normal; color:#000000;">nNum</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">,</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">;</text><br/><tab /><tab /><tab /><text style="font-weight:bold; font-style:normal; color:#0000ff;">&quot;999,999,999,999.99&quot;)</text><br/><tab /><tab /><text style="font-weight:bold; font-style:normal; color:#000000;">cNum </text><text style="font-weight:bold; font-style:normal; color:#0000ff;">:=</text><text style="font-weight:bold; font-style:normal; color:#000000;"> PadL</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">(&quot;$&quot;</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">+</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">LTRIM</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">(</text><text style="font-weight:bold; font-style:normal; color:#000000;">cNum</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">),</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">;</text><br/><tab /><tab /><tab /><text style="font-weight:bold; font-style:normal; color:#ff0000;">LEN</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">(</text><text style="font-weight:bold; font-style:normal; color:#000000;">cNum</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">))</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#ff0000;">ENDIF</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#ff0000;">RETURN</text><text style="font-weight:bold; font-style:normal; color:#000000;"> cNum</text></para>
    <para styleclass="Normal">下一个示例演示了一个函数，该函数接收一个格式化为逗号分隔列表的字符串，并返回一个数组，每个项包含一个元素：</para>
    <para styleclass="Code Example"><text style="font-weight:bold; font-style:normal; color:#000000;">aList </text><text style="font-weight:bold; font-style:normal; color:#0000ff;">:=</text><text style="font-weight:bold; font-style:normal; color:#000000;"> ListAsArray</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">(&quot;One, Two&quot;)</text><br/><text style="font-weight:bold; font-style:normal; color:#ff00ff;">// Result: &#160;{&quot;One&quot;, &quot;Two&quot;}</text><br/><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">FUNCTION</text><text style="font-weight:bold; font-style:normal; color:#000000;"> ListAsArray</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">(</text><text style="font-weight:bold; font-style:normal; color:#000000;">cList</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">)</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#ff0000;">LOCAL</text><text style="font-weight:bold; font-style:normal; color:#000000;"> nPos</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#ff0000;">LOCAL</text><text style="font-weight:bold; font-style:normal; color:#000000;"> aList </text><text style="font-weight:bold; font-style:normal; color:#0000ff;">:=</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">{}</text><tab /><tab /><tab /><text style="font-weight:bold; font-style:normal; color:#ff00ff;">// 定义空数组</text><br/><tab /><br/><tab /><text style="font-weight:bold; font-style:normal; color:#ff0000;">DO</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">WHILE</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">(</text><text style="font-weight:bold; font-style:normal; color:#000000;">nPos </text><text style="font-weight:bold; font-style:normal; color:#0000ff;">:=</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">AT</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">(&quot;,&quot;,</text><text style="font-weight:bold; font-style:normal; color:#000000;"> cList</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">))</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">!=</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">0</text><br/><tab /><tab /><tab /><tab /><tab /><tab /><tab /><text style="font-weight:bold; font-style:normal; color:#ff00ff;">// 增加新元素</text><br/><tab /><tab /><text style="font-weight:bold; font-style:normal; color:#ff0000;">AADD</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">(</text><text style="font-weight:bold; font-style:normal; color:#000000;">aList</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">,</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">SUBSTR</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">(</text><text style="font-weight:bold; font-style:normal; color:#000000;">cList</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">,</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">1,</text><text style="font-weight:bold; font-style:normal; color:#000000;"> nPos </text><text style="font-weight:bold; font-style:normal; color:#0000ff;">-</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">1))</text><br/><tab /><tab /><text style="font-weight:bold; font-style:normal; color:#000000;">cList </text><text style="font-weight:bold; font-style:normal; color:#0000ff;">:=</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">SUBSTR</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">(</text><text style="font-weight:bold; font-style:normal; color:#000000;">cList</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">,</text><text style="font-weight:bold; font-style:normal; color:#000000;"> nPos </text><text style="font-weight:bold; font-style:normal; color:#0000ff;">+</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">1)</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#ff0000;">ENDDO</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#ff0000;">AADD</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">(</text><text style="font-weight:bold; font-style:normal; color:#000000;">aList</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">,</text><text style="font-weight:bold; font-style:normal; color:#000000;"> cList</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">)</text><br/><tab /><br/><tab /><text style="font-weight:bold; font-style:normal; color:#ff0000;">RETURN</text><text style="font-weight:bold; font-style:normal; color:#000000;"> aList</text><tab /><tab /><tab /><tab /><text style="font-weight:bold; font-style:normal; color:#ff00ff;">// 返回数组</text></para>
    <para styleclass="Normal">此示例通过将参数与 NIL 比较，检查是否有跳过的参数：</para>
    <para styleclass="Code Example"><text style="font-weight:bold; font-style:normal; color:#ff0000;">FUNCTION</text><text style="font-weight:bold; font-style:normal; color:#000000;"> MyFunc</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">(</text><text style="font-weight:bold; font-style:normal; color:#000000;">param1</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">,</text><text style="font-weight:bold; font-style:normal; color:#000000;">param2</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">,</text><text style="font-weight:bold; font-style:normal; color:#000000;">param3</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">)</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#ff0000;">IF</text><text style="font-weight:bold; font-style:normal; color:#000000;"> param2 </text><text style="font-weight:bold; font-style:normal; color:#0000ff;">=</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">NIL</text><br/><tab /><tab /><text style="font-weight:bold; font-style:normal; color:#000000;">param2 </text><text style="font-weight:bold; font-style:normal; color:#0000ff;">:=</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">&quot;默认值&quot;</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#ff0000;">ENDIF</text><tab />...</para>
    <para styleclass="Normal">这里使用 Currency() 函数(定义如上)作为别名表达式：</para>
    <para styleclass="Code Example"><text style="font-weight:bold; font-style:normal; color:#000000;">USE invoices NEW</text><br/><text style="font-weight:bold; font-style:normal; color:#000000;">USE customer NEW</text><br/><text style="font-weight:bold; font-style:normal; color:#0000ff;">?</text><text style="font-weight:bold; font-style:normal; color:#000000;"> Invoices</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">-&gt;</text><text style="font-weight:bold; font-style:normal; color:#000000;">Currency</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">(</text><text style="font-weight:bold; font-style:normal; color:#000000;">Amount</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">)</text></para>
    <para styleclass="Heading1">参见</para>
    <para styleclass="Normal"><link displaytype="text" defaultstyle="true" type="topiclink" href="command_FIELD">FIELD</link><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="command_LOCAL">LOCAL</link><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="command_MEMVAR">MEMVAR</link><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="command_METHOD">METHOD</link><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="command_PROCEDURE">PROCEDURE</link><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="command_RETURN">RETURN</link></para>
    <para styleclass="" style="text-align:left; text-indent:0px; margin-top:0px; margin-right:16px; margin-bottom:0px; margin-left:12px; line-height:1.00; background-color:transparent; white-space:normal; page-break-inside:auto; page-break-after:auto; border:none; tabstops:144px left ;"></para>
  </body>
</topic>
