<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../helpproject.xsl" ?>
<topic template="Default" modified="2023-10-22T13:02:38.923-07:00" lasteditedby="robert" version="2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../helpproject.xsd">
  <title>REPEAT UNTIL Statement</title>
  <keywords>
    <keyword>Branching</keyword>
    <keyword>Conditional execution</keyword>
    <keyword>EXIT statement</keyword>
    <keyword>LOOP statement</keyword>
    <keyword>Looping</keyword>
    <keyword>Program control</keyword>
    <keyword>REPEAT Statement</keyword>
    <keyword>Statements</keyword>
    <keyword>UNTIL statement</keyword>
  </keywords>
  <body>
    <header>
      <para styleclass="Heading1">REPEAT UNTIL Statement</para>
    </header>
    <para styleclass="Heading1">Purpose</para>
    <para styleclass="Normal">Execute a loop until a condition is TRUE.</para>
    <para styleclass="Heading1">Syntax</para>
    <para styleclass="Code with box">REPEAT <br/><tab />&lt;<text style="font-style:italic;">Statements</text>&gt;...<br/>[EXIT]<br/><tab />&lt;<text style="font-style:italic;">Statements</text>&gt;...<br/>[LOOP]<br/><tab />&lt;<text style="font-style:italic;">Statements</text>&gt;...<br/>UNTIL &lt;<text style="font-style:italic;">lCondition</text>&gt;</para>
    <para styleclass="Heading1">Arguments</para>
    <para styleclass="List">&lt;<text style="font-style:italic;">lCondition</text>&gt;<tab />The logical control expression for the REPEAT UNTIL loop.</para>
    <para styleclass="List"></para>
    <para styleclass="List"><snippet src="__ExitLoop" inline="false"/></para>
    <para styleclass="Heading1">Description</para>
    <para styleclass="Normal">As long as the condition evaluates to FALSE then the loop will continuet. When the condition evaluates to false, the REPEAT construct terminates and control passes to the statement immediately following the UNTIL.</para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal">Use EXIT to terminate a <text styleclass="List">REPEAT UNTIL</text> structure based on a condition other than the <text styleclass="List">REPEAT UNTIL</text> condition. &#160;LOOP, by contrast, prevents execution of statements within a <text styleclass="List">REPEAT UNTIL</text> based on an intermediate condition, and returns to the most recent <text styleclass="List">REPEAT UNTIL</text> statement.</para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal">Control structures can be nested to any depth. &#160;The only requirement is that each control structure be properly nested.</para>
    <para styleclass="Heading1">Examples</para>
    <para styleclass="Normal">This example demonstrates a typical control structure for a simple grouped report:</para>
    <para styleclass="Normal"></para>
    <para styleclass="Code Example"><text style="font-weight:bold; font-style:normal; color:#ff0000;">LOCAL</text><text style="font-weight:bold; font-style:normal; color:#000000;"> cOldSalesman</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">,</text><text style="font-weight:bold; font-style:normal; color:#000000;"> nTotalAmount</text><br/><text style="font-weight:bold; font-style:normal; color:#000000;">USE sales INDEX salesman NEW</text><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">DO</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">WHILE</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">.NOT.</text><text style="font-weight:bold; font-style:normal; color:#000000;"> &#160;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">EOF</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">()</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#000000;">cOldSalesman </text><text style="font-weight:bold; font-style:normal; color:#0000ff;">:=</text><text style="font-weight:bold; font-style:normal; color:#000000;"> Sales</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">-&gt;</text><text style="font-weight:bold; font-style:normal; color:#000000;">Salesman</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#000000;">nTotalAmount </text><text style="font-weight:bold; font-style:normal; color:#0000ff;">:=</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">0</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#ff0000;">DO</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">WHILE</text><text style="font-weight:bold; font-style:normal; color:#000000;"> cOldSalesman </text><text style="font-weight:bold; font-style:normal; color:#0000ff;">=</text><text style="font-weight:bold; font-style:normal; color:#000000;"> Sales</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">-&gt;</text><text style="font-weight:bold; font-style:normal; color:#000000;">Salesman </text><text style="font-weight:bold; font-style:normal; color:#0000ff;">;</text><br/><tab /><tab /><tab /><text style="font-weight:bold; font-style:normal; color:#0000ff;">.</text><text style="font-weight:bold; font-style:normal; color:#000000;">AND</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">.</text><text style="font-weight:bold; font-style:normal; color:#000000;"> &#160;</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">(.NOT.</text><text style="font-weight:bold; font-style:normal; color:#000000;"> &#160;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">EOF</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">())</text><br/><tab /><tab /><text style="font-weight:bold; font-style:normal; color:#0000ff;">?</text><text style="font-weight:bold; font-style:normal; color:#000000;"> Sales</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">-&gt;</text><text style="font-weight:bold; font-style:normal; color:#000000;">Salesman</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">,</text><text style="font-weight:bold; font-style:normal; color:#000000;"> Sales</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">-&gt;</text><text style="font-weight:bold; font-style:normal; color:#000000;">Amount</text><br/><tab /><tab /><text style="font-weight:bold; font-style:normal; color:#000000;">nTotalAmount </text><text style="font-weight:bold; font-style:normal; color:#0000ff;">:=</text><text style="font-weight:bold; font-style:normal; color:#000000;"> nTotalAmount </text><text style="font-weight:bold; font-style:normal; color:#0000ff;">+</text><text style="font-weight:bold; font-style:normal; color:#000000;"> Sales</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">-&gt;</text><text style="font-weight:bold; font-style:normal; color:#000000;">Amount</text><br/><tab /><tab /><text style="font-weight:bold; font-style:normal; color:#000000;">SKIP</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#ff0000;">ENDDO</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#0000ff;">?</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">&quot;Total: &#160;&quot;,</text><text style="font-weight:bold; font-style:normal; color:#000000;"> nTotalAmount</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">,</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">&quot;for&quot;,</text><text style="font-weight:bold; font-style:normal; color:#000000;"> cOldSalesman</text><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">ENDDO</text><br/><text style="font-weight:bold; font-style:normal; color:#000000;">CLOSE sales</text><br/></para>
    <para styleclass="Normal">This code fragment demonstrates how LOOP can be used to provide an intermediate processing condition:</para>
    <para styleclass="Normal"></para>
    <para styleclass="Code Example"><text style="font-weight:bold; font-style:normal; color:#ff0000;">DO</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">WHILE</text><text style="font-weight:bold; font-style:normal; color:#000000;"> &lt;lCondition</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">&gt;</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#000000;">&lt;Initial Processing</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">&gt;...</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#ff0000;">IF</text><text style="font-weight:bold; font-style:normal; color:#000000;"> &lt;Intermediate Condition</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">&gt;</text><br/><tab /><tab /><text style="font-weight:bold; font-style:normal; color:#ff0000;">LOOP</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#ff0000;">ENDIF</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#000000;">&lt;Continued Processing</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">&gt;...</text><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">ENDDO</text></para>
    <para styleclass="Normal">The next example demonstrates the use of DO WHILE to emulate a &quot;repeat until looping&quot; construct:</para>
    <para styleclass="Normal"></para>
    <para styleclass="Code Example"><text style="font-weight:bold; font-style:normal; color:#ff0000;">LOCAL</text><text style="font-weight:bold; font-style:normal; color:#000000;"> lMore </text><text style="font-weight:bold; font-style:normal; color:#0000ff;">:=</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">TRUE</text><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">DO</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">WHILE</text><text style="font-weight:bold; font-style:normal; color:#000000;"> lMore</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#000000;">&lt;Statements</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">&gt;...</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#000000;">lMore </text><text style="font-weight:bold; font-style:normal; color:#0000ff;">:=</text><text style="font-weight:bold; font-style:normal; color:#000000;"> &lt;lCondition</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">&gt;</text><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">ENDDO</text></para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal">Here, a DO WHILE loop moves sequentially through a database file:</para>
    <para styleclass="Normal"></para>
    <para styleclass="Code Example"><text style="font-weight:bold; font-style:normal; color:#ff0000;">DO</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">WHILE</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">.NOT.</text><text style="font-weight:bold; font-style:normal; color:#000000;"> &#160;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">EOF</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">()</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#000000;">&lt;Statements</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">&gt;...</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#000000;">SKIP</text><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">ENDDO</text></para>
    <para styleclass="Heading1">See Also</para>
    <para styleclass="Normal"><link displaytype="text" defaultstyle="true" type="topiclink" href="command_BEGIN_SEQUENCE">BEGIN SEQUENCE</link><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="html\M_XSharp_RT_Functions_DbEval.htm" domain="XSharpRef.chm">DBEval()</link><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="command_DO_CASE">DO CASE</link><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="command_FOR">FOR</link><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="command_IF">IF</link><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="command_RETURN">RETURN</link>, <link displaytype="text" defaultstyle="true" type="topiclink" href="command_DO_WHILE">DO WHILE</link>, <link displaytype="text" defaultstyle="true" type="topiclink" href="command_EXIT">EXIT</link>, <link displaytype="text" defaultstyle="true" type="topiclink" href="command_LOOP">LOOP</link></para>
    <para styleclass="Normal"></para>
  </body>
</topic>
