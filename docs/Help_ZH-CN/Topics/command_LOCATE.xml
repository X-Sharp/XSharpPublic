<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../helpproject.xsl" ?>
<topic template="Default" modified="2024-07-26T10:44:40.286+08:00" lasteditedby="niuji" version="2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../helpproject.xsd">
  <title>LOCATE 命令</title>
  <keywords>
    <keyword>Commands</keyword>
    <keyword>Databases</keyword>
    <keyword>Finding<keyword>records</keyword></keyword>
    <keyword>LOCATE command</keyword>
    <keyword>Records<keyword>finding</keyword></keyword>
  </keywords>
  <body>
    <header>
      <para styleclass="Heading1">LOCATE 命令</para>
    </header>
    <para styleclass="Normal"><snippet src="__CommandInclude" inline="false"/></para>
    <para styleclass="Heading1">用途</para>
    <para styleclass="Normal">搜索当前工作区中符合指定条件和范围的第一条记录。</para>
    <para styleclass="Heading1">语法</para>
    <para styleclass="Code with box">LOCATE [&lt;<text styleclass="Italic">Scope</text>&gt;] FOR &lt;<text styleclass="Italic">lCondition</text>&gt; [WHILE &lt;<text styleclass="Italic">lCondition</text>&gt;]</para>
    <para styleclass="Heading1">参数</para>
    <para styleclass="List"><snippet src="__Scope" inline="false"/></para>
    <para styleclass="List"><snippet src="__While" inline="false"/></para>
    <para styleclass="List"><snippet src="__For" inline="false"/></para>
    <para styleclass="Heading1">描述</para>
    <para styleclass="Normal">LOCATE 使用 for 条件评估范围内的每条可见记录。 一旦有记录符合条件，进程就会终止，并将记录指针留在匹配记录上，同时将 <link displaytype="text" defaultstyle="true" type="topiclink" href="html\M_XSharp_RT_Functions_Found.htm" domain="XSharpRef.chm">Found()</link> 标志设置为 &quot;true&quot;。 如果对于作用域中的所有记录，for 条件都是 FALSE，那么 Found() 标志将设置为 FALSE，记录指针的位置取决于作用域。</para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal">每个工作区都有自己的定位条件，在执行另一个定位操作(如使用 LOCATE 或 DBLocate())、重置定位条件(如使用 VODBSetLocate())或终止应用程序之前，该条件一直处于激活状态。</para>
    <para styleclass="Heading1">备注</para>
    <para styleclass="Normal"><text styleclass="BoldItalic" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-decoration:none; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">CONTINUE：一旦找到记录并对其进行了处理，就可以使用 CONTINUE(或 DBContinue())从当前记录指针位置继续搜索。 不过，&lt;Scope&gt; 和 while 条件都只适用于初始定位操作，后续的继续操作并不知晓。 要继续进行带有范围或 while 条件的待定位操作，请使用 SKIP 然后 LOCATE REST WHILE &lt;lCondition&gt; 代替 CONTINUE，如下例所示。</text></para>
    <para styleclass="Heading1">示例</para>
    <para styleclass="Normal">这些示例展示了典型的 LOCATE 结构：</para>
    <para styleclass="Code Example"><text style="font-weight:bold; font-style:normal; color:#000000;">USE sales INDEX salesman</text><br/><text style="font-weight:bold; font-style:normal; color:#000000;">LOCATE </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">FOR</text><text style="font-weight:bold; font-style:normal; color:#000000;"> Branch </text><text style="font-weight:bold; font-style:normal; color:#0000ff;">=</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">&quot;200&quot;</text><br/><text style="font-weight:bold; font-style:normal; color:#0000ff;">?</text><text style="font-weight:bold; font-style:normal; color:#000000;"> Found</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">(),</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">EOF</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">(),</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">RECNO</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">()</text><tab /><text style="font-weight:bold; font-style:normal; color:#ff00ff;">// Result: &#160;TRUE FALSE 5</text><br/><text style="font-weight:bold; font-style:normal; color:#000000;">LOCATE </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">FOR</text><text style="font-weight:bold; font-style:normal; color:#000000;"> Branch </text><text style="font-weight:bold; font-style:normal; color:#0000ff;">=</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">&quot;5000&quot;</text><br/><text style="font-weight:bold; font-style:normal; color:#0000ff;">?</text><text style="font-weight:bold; font-style:normal; color:#000000;"> Found</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">(),</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">EOF</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">(),</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">RECNO</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">()</text><tab /><text style="font-weight:bold; font-style:normal; color:#ff00ff;">// Result: &#160;FALSE TRUE 85</text></para>
    <para styleclass="Normal">下一个示例显示了一个带有 WHILE 条件的 LOCATE，该条件通过使用 LOCATE REST 得到延续：</para>
    <para styleclass="Code Example"><text style="font-weight:bold; font-style:normal; color:#000000;">SEEK </text><text style="font-weight:bold; font-style:normal; color:#0000ff;">&quot;Bill&quot;</text><br/><text style="font-weight:bold; font-style:normal; color:#000000;">LOCATE </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">FOR</text><text style="font-weight:bold; font-style:normal; color:#000000;"> Branch </text><text style="font-weight:bold; font-style:normal; color:#0000ff;">=</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">&quot;200&quot;</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">WHILE</text><text style="font-weight:bold; font-style:normal; color:#000000;"> Salesman </text><text style="font-weight:bold; font-style:normal; color:#0000ff;">=</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">&quot;Bill&quot;</text><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">DO</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">WHILE</text><text style="font-weight:bold; font-style:normal; color:#000000;"> Found</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">()</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#0000ff;">?</text><text style="font-weight:bold; font-style:normal; color:#000000;"> Branch</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">,</text><text style="font-weight:bold; font-style:normal; color:#000000;"> Salesman</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#000000;">SKIP</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#000000;">LOCATE REST </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">FOR</text><text style="font-weight:bold; font-style:normal; color:#000000;"> Branch </text><text style="font-weight:bold; font-style:normal; color:#0000ff;">=</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">&quot;200&quot;</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">WHILE</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">;</text><br/><tab /><tab /><tab /><tab /><text style="font-weight:bold; font-style:normal; color:#000000;">Salesman </text><text style="font-weight:bold; font-style:normal; color:#0000ff;">=</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">&quot;Bill&quot;</text><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">ENDDO</text></para>
    <para styleclass="Body Text"><snippet src="__IncludeLibRt" inline="false"/></para>
    <para styleclass="Heading1">参见</para>
    <para styleclass="Normal"><link displaytype="text" defaultstyle="true" type="topiclink" href="command_CONTINUE">CONTINUE</link><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="html\M_XSharp_RT_Functions_DbContinue.htm" domain="XSharpRef.chm">DbContinue()</link><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="html\M_XSharp_RT_Functions_DbLocate.htm" domain="XSharpRef.chm">DbLocate()</link><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="html\M_XSharp_RT_Functions_Eof.htm" domain="XSharpRef.chm">EoF()</link><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="html\M_XSharp_RT_Functions_Found.htm" domain="XSharpRef.chm">Found()</link><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="html\M_XSharp_RT_Functions_RecNo.htm" domain="XSharpRef.chm">RecNo()</link><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="command_SEEK">SEEK</link><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="html\M_XSharp_RT_Functions_DbSetFilter.htm" domain="XSharpRef.chm">DbSetFilter()</link></para>
    <para styleclass="Normal"></para>
  </body>
</topic>
