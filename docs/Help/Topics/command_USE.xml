<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../helpproject.xsl" ?>
<topic template="Default" lasteditedby="robert" version="2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../helpproject.xsd">
  <title>USE Command</title>
  <keywords>
    <keyword>Commands</keyword>
    <keyword>Concurrency control</keyword>
    <keyword>Databases</keyword>
    <keyword>Files<keyword>opening</keyword></keyword>
    <keyword>Opening<keyword>files</keyword></keyword>
    <keyword>USE command</keyword>
  </keywords>
  <body>
    <header>
      <para styleclass="Heading1">USE Command</para>
    </header>
    <para styleclass="Normal"><snippet src="__CommandInclude" inline="false"/></para>
    <para styleclass="Heading1">Purpose</para>
    <para styleclass="Normal">Open an existing database file, its associated memo file, and optionally associated index files in the current or the next available work area.</para>
    <para styleclass="Heading1">Syntax</para>
    <para styleclass="Code with box">USE [&lt;xcDataFile&gt; [INDEX &lt;xcIndexList&gt;] [ALIAS &lt;xcAlias&gt;] [FIELDS &lt;aFields&gt;] [NEW] [READONLY] <br/><tab />[EXCLUSIVE | SHARED] [VIA &lt;cDriver&gt;] [INHERIT &lt;acRDDs&gt;]]</para>
    <para styleclass="Heading1">Arguments</para>
    <para styleclass="List">&lt;xcDataFile&gt;<tab />The name of the database file to open, including an optional drive, directory, and extension. &#160;If the database file has a corresponding memo file, it is also opened. &#160;The default extension for database and memo files is determined by the RDD.</para>
    <para styleclass="List"></para>
    <para styleclass="List">INDEX &lt;xcIndexFileList&gt;</para>
    <para styleclass="List"><tab />The names of the index files to open, including an optional drive, directory, and extension for each. &#160;The default extension is determined by the RDD and can be obtained using DBOrderInfo(DBOI_INDEXEXT). &#160;</para>
    <para styleclass="List"></para>
    <para styleclass="List"><tab />If you specify &lt;xcIndexList&gt; as an expression and the value returned is spaces or NIL, it is ignored.</para>
    <para styleclass="List"></para>
    <para styleclass="List"><tab />It is recommended that you open index files with SET INDEX or DBSetIndex() for proper resolution in case of a concurrency conflict.</para>
    <para styleclass="List"></para>
    <para styleclass="List"><tab />If the database file, its corresponding memo file, or any of the index files does not exist, a runtime error is raised. &#160;See SetDefault() and SetPath() for file searching and creation rules.</para>
    <para styleclass="List"></para>
    <para styleclass="List">ALIAS &lt;xcAlias&gt;<tab />An identifier name to associate with the work area when &lt;xcDataFile&gt; is opened. &#160;If not specified, the alias defaults to the database file name. &#160;Duplicate alias names are not allowed within a single application.</para>
    <para styleclass="List"></para>
    <para styleclass="List">FIELDS &lt;aFields&gt;<tab />An array containing field descriptions in the format returned by DBStruct().</para>
    <para styleclass="List"></para>
    <para styleclass="List"><tab />This argument does not apply to DBF files. &#160;It is intended for use with file formats that do not store field descriptions. &#160;For example, if you use an RDD that supports SDF or delimited files, you can use this argument to define the file structure, which can then be used with other commands or functions to access the field descriptions. &#160;Here is an example of this argument:</para>
    <para styleclass="List"></para>
    <para styleclass="Code Example"><tab /><tab /><tab /><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">aFields := {;</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; &#160; &#160; &#160; &#160; &#160;</text><tab /><tab /><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">{&quot;First&quot;, &quot;C&quot;, 35, 0};</text><br/><tab /><tab /><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; &#160; &#160; &#160; &#160; &#160;</text><tab /><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">{&quot;Last&quot;, &quot;C&quot;, 35, 0};</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; &#160; &#160; &#160; &#160;</text><tab /><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160;</text><tab /><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">{&quot;Birthday&quot;, &quot;D&quot;, 8, 0}}</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; &#160; &#160; &#160; </text><tab /><tab /><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">USE</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> Names </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">FIELDS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> aFields VIA &quot;DELIM&quot;</text><br/><tab /><tab /><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; &#160; &#160;? First &#160; &#160; &#160; &#160; &#160; &#160;</text><text style="font-weight:bold; font-style:italic; text-decoration:none; color:#339966;">// Return: &#160;Josie</text></para>
    <para styleclass="List"></para>
    <para styleclass="List">NEW<tab />Selects the next available work area before opening &lt;xcDataFile&gt;. &#160;If not specified, &lt;xcDataFile&gt; is opened in the current work area.</para>
    <para styleclass="List"></para>
    <para styleclass="List">READONLY<tab />Attempts to open &lt;xcDataFile&gt; with a read-only attribute, prohibiting updates to the work area. &#160;If not specified, &lt;xcDataFile&gt; is opened read-write, allowing updates. &#160;If &lt;xcDataFile&gt; cannot be accessed using the indicated attribute, a runtime error is raised.</para>
    <para styleclass="List"></para>
    <para styleclass="List">EXCLUSIVE<tab />Attempts to open &lt;xcDataFile&gt; for exclusive (non-shared) use. &#160;All other processes are denied access until the database file is closed.</para>
    <para styleclass="List"></para>
    <para styleclass="List">SHARED<tab />Attempts to open &lt;xcDataFile&gt; for shared use.</para>
    <para styleclass="List"></para>
    <para styleclass="List"><tab />If neither SHARED nor EXCLUSIVE is specified, the USE command attempts to open &lt;xcDataFile&gt; in the mode indicated by the SetExclusive() flag. &#160;However, it is highly recommended that you specify the open mode as part of the USE command rather than relying on SetExclusive() to determine it for you.</para>
    <para styleclass="List"></para>
    <para styleclass="List">VIA &lt;cDriver&gt;<tab />The name of the RDD that will service the work area. &#160;If not specified, the default RDD as determined by <link displaytype="text" defaultstyle="true" type="topiclink" href="html\Overload_XSharp_RT_Functions_RddSetDefault.htm" domain="XSharpRef.chm" styleclass="Normal">RDDSetDefault()</link> is used.</para>
    <para styleclass="List"></para>
    <para styleclass="List">INHERIT &lt;acRDDs&gt;<tab />A one-dimensional array with the names of RDDs from which the main RDD inherits special functionality. &#160;This allows you to use RDDs with special capabilities, like encryption or decryption, in different work areas with different database drivers. &#160;These RDDs overlay special functions of the main RDD (specified with the VIA clause). &#160;If multiple RDDs (specified with this INHERIT clause) implement the same function, the function associated with the last RDD in the list takes precedence.</para>
    <para styleclass="List"></para>
    <para styleclass="List"><tab />USE specified with no arguments closes the database file open in the current work area.</para>
    <para styleclass="Heading1">Description</para>
    <para styleclass="Normal">The USE command attempts to open &lt;<text styleclass="Italic">xcDataFile</text>&gt; (and its associated .DBF file, if any) in the indicated mode. &#160;If the file is successfully opened, the operation proceeds to open any indicated index files in the same mode — any files that were already open in the work area are closed. &#160;The first order in the first index file in the list becomes the controlling order.</para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal">If access is denied because, for example, another process has exclusive use of the database file, NetErr() is set to TRUE but no runtime error is raised. &#160;For this reason, it is recommended that you open index files as a separate operation (with SET INDEX or DBSetIndex()). &#160;Otherwise, a runtime error will result when the USE command tries to open the first index file in the list because the database file will not be open.</para>
    <para styleclass="Normal">When a database file is first opened, the record pointer is positioned at the first logical record in the file (record one if there is no controlling order).</para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal">If the database file is opened in shared mode, other processes can have concurrent access to the file and responsibility for data integrity falls on the application program. &#160;File and record locking (using, <link displaytype="text" defaultstyle="true" type="topiclink" href="html\M_XSharp_RT_Functions_Flock.htm" domain="XSharpRef.chm">FLock()</link>, <link displaytype="text" defaultstyle="true" type="topiclink" href="html\M_XSharp_RT_Functions_RLock.htm" domain="XSharpRef.chm">RLock()</link>, or DBRLock()) are the basic means of denying other processes access to a particular file or record.</para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal">Refer to the CLOSE command for information on how to close files of all types.</para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal">USE is functionally equivalent to DBUseArea(). &#160;</para>
    <para styleclass="Heading1">Examples</para>
    <para styleclass="Normal">This example opens a shared database file with associated index files. &#160;If NetErr() returns FALSE, indicating the USE was successful, the indexes are opened:</para>
    <para styleclass="Normal"></para>
    <para styleclass="Code Example"><text style="font-weight:bold; font-style:normal; color:#ff0000;">USE</text><text style="font-weight:normal; font-style:normal; color:#000000;"> accounts SHARED </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">NEW</text><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">IF</text><text style="font-weight:normal; font-style:normal; color:#000000;"> !NetErr()</text><br/><text style="font-weight:normal; font-style:normal; color:#000000;"> &#160; </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">SET</text><text style="font-weight:normal; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">INDEX</text><text style="font-weight:normal; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">TO</text><text style="font-weight:normal; font-style:normal; color:#000000;"> acctnames, acctzip</text><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">ELSE</text><br/><text style="font-weight:normal; font-style:normal; color:#000000;"> &#160; ? &quot;File open failed&quot;</text><br/><text style="font-weight:normal; font-style:normal; color:#000000;"> &#160; </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">BREAK</text><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">ENDIF</text></para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal">This example opens a database file with several index files specified as extended expressions:</para>
    <para styleclass="Normal"></para>
    <para styleclass="Code Example"><text style="font-weight:normal; font-style:normal; color:#000000;">cDataFile = &quot;MyDbf&quot;</text><br/><text style="font-weight:normal; font-style:normal; color:#000000;">acIndex = {&quot;MyIndex1&quot;, &quot;MyIndex2&quot;, &quot;MyIndex3&quot;}</text><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">USE</text><text style="font-weight:normal; font-style:normal; color:#000000;"> (cDataFile) </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">INDEX</text><text style="font-weight:normal; font-style:normal; color:#000000;"> (acIndex[1]), ;</text><br/><text style="font-weight:normal; font-style:normal; color:#000000;"> &#160; &#160; &#160;(acIndex[2]), (acIndex[3])</text></para>
    <para styleclass="Body Text"><snippet src="__IncludeLibRt" inline="false"/></para>
    <para styleclass="Heading1">See Also</para>
    <para styleclass="Normal"><link displaytype="text" defaultstyle="true" type="topiclink" href="command_CLOSE">CLOSE</link><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="html\M_XSharp_RT_Functions_DbSelect.htm" domain="XSharpRef.chm">DbSelect()</link><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="html\M_XSharp_RT_Functions_DbSetIndex.htm" domain="XSharpRef.chm">DbSetIndex()</link><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="html\M_XSharp_RT_Functions_DbSetOrder.htm" domain="XSharpRef.chm">DbSetOrder()</link><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="html\M_XSharp_RT_Functions_DbUseArea.htm" domain="XSharpRef.chm">DbUseArea()</link><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="html\Overload_XSharp_Core_Functions_NetErr.htm" domain="XSharpRef.chm">NetErr()</link><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="html\M_XSharp_RT_Functions_RddSetDefault.htm" domain="XSharpRef.chm">RddSetDefault()</link><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">&#32;</text><link displaytype="text" defaultstyle="true" type="topiclink" href="command_SELECT">SELECT</link><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="command_SET_INDEX">SET INDEX</link><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="html\M_XSharp_RT_Functions_Used.htm" domain="XSharpRef.chm">Used()</link><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">&#32;</text></para>
    <para styleclass="Normal"></para>
  </body>
</topic>
