<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../helpproject.xsl" ?>
<topic template="Default" modified="2024-07-26T10:47:16.292+08:00" lasteditedby="niuji" version="2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../helpproject.xsd">
  <title>SET RELATION 命令</title>
  <keywords>
    <keyword>Commands</keyword>
    <keyword>Databases</keyword>
    <keyword>SET RELATION command</keyword>
    <keyword>Setting<keyword>work area relations</keyword></keyword>
    <keyword>Work areas<keyword>relating</keyword></keyword>
  </keywords>
  <body>
    <header>
      <para styleclass="Heading1">SET RELATION 命令</para>
    </header>
    <para styleclass="Normal"><snippet src="__CommandInclude" inline="false"/></para>
    <para styleclass="Heading1">用途</para>
    <para styleclass="Normal">使用关键表达式、记录编号或数字表达式将父工作区链接到一个或多个子工作区。</para>
    <para styleclass="Heading1">语法</para>
    <para styleclass="Code with box">SET RELATION TO [&lt;uRecID&gt; INTO &lt;xcAlias&gt;] [, [TO] &lt;uRecId&gt; INTO &lt;xcAlias&gt;...] [ADDITIVE] [SCOPED]</para>
    <para styleclass="Heading1">参数</para>
    <para styleclass="List">TO &lt;uRecID&gt;<tab />如果子工作区有控制命令，则执行 &lt;xcAlias&gt;-&gt;DBSeek(&lt;uRecID&gt;) 操作；否则，执行 &lt;xcAlias&gt;-&gt;DBGoTo(&lt;uRecID&gt;) 操作。 每次记录指针在父工作区移动时，该操作都会将子工作区定位到匹配的索引键值或记录编号。</para>
    <para styleclass="List"></para>
    <para styleclass="List">INTO &lt;xcAlias&gt;<tab />子工作区的别名标识符。 如果指定的别名没有关联的开放数据库文件，则会出现运行时错误。</para>
    <para styleclass="List"></para>
    <para styleclass="List">ADDITIVE<tab />指定将关系添加到工作区的现有关系中。 如果未指定，则在设置新关系之前会清除现有关系。</para>
    <para styleclass="List"></para>
    <para styleclass="List">SCOPED<tab />使 SET RELATION 命令映射到 OrdSetRelation() 命令。 如果未指定，SET RELATION 会映射到 DBSetRelation()。</para>
    <para styleclass="List"></para>
    <para styleclass="List">SET RELATION TO 不带参数，清除当前工作区中定义的所有关系。</para>
    <para styleclass="Heading1">描述</para>
    <para styleclass="Normal">每个父工作区最多可连接八个子工作区。</para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal">关联工作区可使子工作区与父工作区同步。 每当父工作区移动到一个新记录时，子工作区就会自动重新定位。</para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal">使用表达式和别名列表指定 SET RELATION TO 时，其功能等同于使用多个 DBSetRelation()(或 OrdSetRelation()，如果指定了 SCOPED)函数调用。 如果没有指定 ADDITIVE 子句，命令将首先调用 DBClearRelation()。 </para>
    <para styleclass="Heading1">备注</para>
    <para styleclass="Normal"><text styleclass="BoldItalic" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-decoration:none; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">软查找： &#160;作为关系定位的一部分进行的寻道操作绝不是软寻道(它们不遵守 </text><link displaytype="text" defaultstyle="true" type="topiclink" href="html\Overload_XSharp_Core_Functions_SetSoftSeek.htm" domain="XSharpRef.chm">SetSoftSeek()</link><text styleclass="BoldItalic" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-decoration:none; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;"> 标记)。 如果关系移动不成功，子工作区将定位到 </text><link displaytype="text" defaultstyle="true" type="topiclink" href="html\M_XSharp_RT_Functions_LastRec.htm" domain="XSharpRef.chm">LastRec()</link><text styleclass="BoldItalic" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-decoration:none; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;"> + 1，其 </text><link displaytype="text" defaultstyle="true" type="topiclink" href="html\M_XSharp_RT_Functions_Found.htm" domain="XSharpRef.chm">Found()</link><text styleclass="BoldItalic" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-decoration:none; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;"> 状态返回 FALSE，其 </text><link displaytype="text" defaultstyle="true" type="topiclink" href="html\M_XSharp_RT_Functions_Eof.htm" domain="XSharpRef.chm">EoF()</link><text styleclass="BoldItalic" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-decoration:none; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;"> 状态返回 TRUE。</text></para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal"><text styleclass="BoldItalic" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-decoration:none; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">循环关系： &#160;不要直接或间接将父工作区与自身相关联。</text></para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal"><text styleclass="BoldItalic" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-decoration:none; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">记录编号关系： &#160;要根据匹配的记录编号关联两个工作区，请在 SET RELATION TO 表达式中使用 </text><link displaytype="text" defaultstyle="true" type="topiclink" href="html\M_XSharp_RT_Functions_RecNo.htm" domain="XSharpRef.chm">RecNo()</link><text styleclass="BoldItalic" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-decoration:none; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">，并确保子工作区没有活动索引。</text></para>
    <para styleclass="Heading1">示例</para>
    <para styleclass="Normal">此示例在多父子配置中关联了三个工作区，其中 CUSTOMER 同时与 INVOICES 和 ZIP 相关：</para>
    <para styleclass="Code Example"><text style="font-weight:bold; font-style:normal; color:#ff0000;">USE</text><text style="font-weight:normal; font-style:normal; color:#000000;"> invoices </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">INDEX</text><text style="font-weight:normal; font-style:normal; color:#000000;"> invoices </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">NEW</text><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">USE</text><text style="font-weight:normal; font-style:normal; color:#000000;"> zip </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">INDEX</text><text style="font-weight:normal; font-style:normal; color:#000000;"> zipcode </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">NEW</text><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">USE</text><text style="font-weight:normal; font-style:normal; color:#000000;"> customer </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">NEW</text><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">SET</text><text style="font-weight:normal; font-style:normal; color:#000000;"> RELATION </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">TO</text><text style="font-weight:normal; font-style:normal; color:#000000;"> CustNum </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">INTO</text><text style="font-weight:normal; font-style:normal; color:#000000;"> Invoices, Zipcode </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">INTO</text><text style="font-weight:normal; font-style:normal; color:#000000;"> Zip</text><br/><text style="font-weight:normal; font-style:normal; color:#000000;">LIST Customer, Zip-&gt;City, Invoices-&gt;Number, Invoices-&gt;Amount</text></para>
    <para styleclass="Normal">之后，您可以使用 ADDITIVE 子句添加一个新的子关系，就像这样：</para>
    <para styleclass="Code Example"><text style="font-weight:bold; font-style:normal; color:#ff0000;">USE</text><text style="font-weight:normal; font-style:normal; color:#000000;"> backorder </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">INDEX</text><text style="font-weight:normal; font-style:normal; color:#000000;"> backorder </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">NEW</text><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">SELECT</text><text style="font-weight:normal; font-style:normal; color:#000000;"> customer</text><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">SET</text><text style="font-weight:normal; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">RELATION</text><text style="font-weight:normal; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">TO</text><text style="font-weight:normal; font-style:normal; color:#000000;"> CustNum </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">INTO</text><text style="font-weight:normal; font-style:normal; color:#000000;"> Backorder </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">ADDITIVE</text></para>
    <para styleclass="Body Text"><snippet src="__IncludeLibRt" inline="false"/></para>
    <para styleclass="Heading1">参见</para>
    <para styleclass="Normal"><link displaytype="text" defaultstyle="true" type="topiclink" href="html\M_XSharp_RT_Functions_DbGoto.htm" domain="XSharpRef.chm">DbGoTo()</link><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="html\M_XSharp_RT_Functions_DbRelation.htm" domain="XSharpRef.chm">DBRelation()</link><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="html\M_XSharp_RT_Functions_DbRSelect.htm" domain="XSharpRef.chm">DBRSelect()</link><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">,, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="html\M_XSharp_RT_Functions_DbSeek.htm" domain="XSharpRef.chm">DbSeek()</link><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="html\M_XSharp_RT_Functions_DbSetIndex.htm" domain="XSharpRef.chm">DbSetIndex()</link><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="html\M_XSharp_RT_Functions_DbSetOrder.htm" domain="XSharpRef.chm">DbSetOrder()</link><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;"> , </text><link displaytype="text" defaultstyle="true" type="topiclink" href="html\M_XSharp_RT_Functions_DbSetRelation.htm" domain="XSharpRef.chm">DBSetRelation()</link><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="html\M_XSharp_RT_Functions_Found.htm" domain="XSharpRef.chm">Found()</link><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="html\M_XSharp_RT_Functions_OrdSetRelation.htm" domain="XSharpRef.chm">OrdSetRelation()</link><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="html\M_XSharp_RT_Functions_RecNo.htm" domain="XSharpRef.chm">RecNo()</link>,<text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">&#32;</text><link displaytype="text" defaultstyle="true" type="topiclink" href="command_SET_INDEX">SET INDEX</link><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="command_SET_ORDER">SET ORDER</link><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="html\Overload_XSharp_Core_Functions_SetSoftSeek.htm" domain="XSharpRef.chm">SetSoftSeek()</link></para>
    <para styleclass="Normal"></para>
  </body>
</topic>
