<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../helpproject.xsl" ?>
<topic template="Default" lasteditedby="robert" version="2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../helpproject.xsd">
  <title>_DLL Statement</title>
  <keywords>
    <keyword>_DLL statement</keyword>
    <keyword>Compile-time declaration</keyword>
    <keyword>Declaration statements</keyword>
    <keyword>DLLs<keyword>declaring</keyword></keyword>
    <keyword>Dynamic linking</keyword>
    <keyword>Entity declaration</keyword>
    <keyword>Statements</keyword>
  </keywords>
  <body>
    <header>
      <para styleclass="Heading1">_DLL Statement</para>
    </header>
    <para styleclass="Heading1">Purpose</para>
    <para styleclass="Body Text">Declare an entity defined in a DLL to the compiler.</para>
    <para styleclass="Heading1">Syntax</para>
    <para styleclass="Code with box"><tab />[Attributes] [Modifiers] _DLL FUNCTION | PROCEDURE<br/><tab />[([&lt;idParam&gt; [AS | REF &lt;idType&gt;] [, ...])] <br/><tab />[AS &lt;idType&gt;]<br/><tab />[&lt;idConvention&gt;]<br/><tab />:&lt;idDLL&gt;.&lt;idEntity&gt;<br/><tab />[CharSet= AUTO|ANSI|UNICODE]</para>
    <para styleclass="Code with box"><text styleclass="Heading1">Arguments</text></para>
    <para styleclass="List">&lt;idEntity&gt;<tab />The name or number of the entity as defined in the DLL. &#160;This is normally, but not necessarily, the same as the entity name defined in &lt;EntityDeclaration&gt;, which may define an alias by which the entity is called in your application. &#160;&lt;idEntity&gt; must be part of the public protocol of the DLL identified by &lt;idDLL&gt;.<br/>IdEntity may also be specified as a literal string. This should be done to specify names of exported functions in DLLs that contain characters that are not allowed as part of an identifier in X#.</para>
    <para styleclass="List"><snippet src="__IncludeParameters" inline="false"/></para>
    <para styleclass="Normal"><snippet src="__callingconvention" inline="false"/></para>
    <para styleclass="List">&lt;idDLL&gt;<tab />The name of the DLL file that contains the entity definition, specified without an extension or path name (that is, its base name). &#160;A .DLL extension is assumed (with some exceptions determined by Windows that may have an .EXE extension), and the rules used to search for the file at runtime are explained in the Description section below.</para>
    <para styleclass="List"></para>
    <para styleclass="List"><text styleclass="Body Text">Charset</text><tab /><text styleclass="Body Text">Optionally specifies which character set string parameters have</text></para>
    <para styleclass="Heading1">Description</para>
    <para styleclass="Body Text">_DLL declares an entity that is used by your application but defined in a DLL. &#160;This statement tells the compiler not only the location and name (or number) of the DLL entity, but also its calling convention (that is, what parameters it expects and the type of value that it returns). &#160;When you declare an entity with the _DLL statement, it also indicates to the compiler that the entity has no additional source code following its declaration.</para>
    <para styleclass="Normal">Once declared, the entity may be called in your application in the standard way.</para>
    <para styleclass="Normal"></para>
    <para styleclass="Body Text"><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">Warning: &#160;</text>Entity names contained within the _DLL statement are case sensitive. This is in direct contradiction to the X# compiler which is not case sensitive but is consistent with Windows calling protocols. For this reason you must take extra care if Case Sensitization is turned on or you have the Caps Lock on.</para>
    <para styleclass="Heading1">Examples</para>
    <para styleclass="Normal">The following examples illustrate _DLL declarations for two Windows API functions:</para>
    <para styleclass="Code Example"><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">_DLL</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">FUNCTION</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> MessageBeep(siLevel </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">SHORTINT</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">) </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">VOID</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> PASCAL:User.MessageBeep</text><br/><br/><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">_DLL</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">FUNCTION</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> MessageBox(hwndParent </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">PTR</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">, pszText </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">PSZ</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">, &#160;pszCapt </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">PSZ</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">, dwFlags </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">DWORD</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">) ;</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">LONG</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> PASCAL:User.MessageBox</text><br/><text style="font-weight:bold; font-style:italic; text-decoration:none; color:#339966;">// You can also declare a function with &quot;normal&quot; string parameters if you want. Add the ANSI or UNICODE clause to indicate which version you want to call.</text><br/><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">_DLL</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">FUNCTION</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> MessageBox(hwndParent </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">PTR</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">, pszText </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">STRING</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">, &#160;pszCapt </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">STRING</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">, dwFlags </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">DWORD</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">) ;</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">LONG</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> PASCAL:User.MessageBox </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">ANSI</text></para>
    <para styleclass="Heading1">See Also</para>
    <para styleclass="Normal"><link displaytype="text" defaultstyle="true" type="topiclink" href="command_ACCESS" styleclass="link" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">ACCESS</link><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="command_ASSIGN" styleclass="link" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">ASSIGN</link><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="command_FUNCTION">FUNCTION</link><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="command_METHOD">METHOD</link><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="command_PROCEDURE">PROCEDURE</link></para>
    <para styleclass="Normal"></para>
  </body>
</topic>
