<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../helpproject.xsl" ?>
<topic template="Default" lasteditedby="robert" version="2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../helpproject.xsd">
  <title>XS9067</title>
  <keywords>
    <keyword>XS9067</keyword>
  </keywords>
  <body>
    <header>
      <para styleclass="Heading1">Error XS9067</para>
    </header>
    <para styleclass="Body Text">This error will be thrown if an interface method has CLIPPER calling convention and the implementation does not have that convention, or vice versa.</para>
    <para styleclass="Body Text">This usually occurs when the interface is declared in an assembly where compiler option /vo5 (Implicit clipper calling convention) has a different setting then the app where the interface is implemented.</para>
    <para styleclass="Body Text">Assume the following code in one assembly</para>
    <para styleclass="Body Text"></para>
    <para styleclass="Code with box"><text style="font-weight:bold; font-style:italic; color:#339966;">// compiled with /vo5-</text><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">INTERFACE</text><text style="font-weight:normal; font-style:normal; color:#000000;"> IProvider</text><br/><text style="font-weight:normal; font-style:normal; color:#000000;"> &#160; </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">METHOD</text><text style="font-weight:normal; font-style:normal; color:#000000;"> DoSomething() </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">VOID</text><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">END</text><text style="font-weight:normal; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">INTERFACE</text></para>
    <para styleclass="Normal" style="line-height:1.00; tabstops:none;"></para>
    <para styleclass="Normal" style="line-height:1.00; tabstops:none;"></para>
    <para styleclass="Normal" style="line-height:1.00; tabstops:none;">And this implementation in another assembly</para>
    <para styleclass="Body Text"></para>
    <para styleclass="Code Example"><text style="font-weight:bold; font-style:italic; text-decoration:none; color:#339966;">// compiled with /vo5+</text><br/><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">CLASS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> MyProvider </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">IMPLEMENTS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> IProvider</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">METHOD</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> DoSomething() </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">VOID</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; &#160; &#160;? &quot;Done&quot;</text><br/><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">END</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">INTERFACE</text></para>
    <para styleclass="Normal" style="line-height:1.00; tabstops:none;"></para>
    <para styleclass="Normal" style="line-height:1.00; tabstops:none;"></para>
    <para styleclass="Normal" style="line-height:1.00; tabstops:none;">At first site the implementation looks OK but because the implementation is compiled with /VO5 then the method will actually be compiled as follows:</para>
    <para styleclass="Body Text"></para>
    <para styleclass="Code with box"><text style="font-weight:bold; font-style:normal; color:#ff0000;">CLASS</text><text style="font-weight:normal; font-style:normal; color:#000000;"> MyProvider </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">IMPLEMENTS</text><text style="font-weight:normal; font-style:normal; color:#000000;"> IProvider</text><br/><text style="font-weight:normal; font-style:normal; color:#000000;"> &#160; </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">METHOD</text><text style="font-weight:normal; font-style:normal; color:#000000;"> DoSomething(aArgs </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">PARAMS</text><text style="font-weight:normal; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">USUAL</text><text style="font-weight:normal; font-style:normal; color:#000000;">[]) </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">VOID</text><br/><text style="font-weight:normal; font-style:normal; color:#000000;"> &#160; &#160; &#160;? &quot;Done&quot;</text><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">END</text><text style="font-weight:normal; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">INTERFACE</text></para>
    <para styleclass="Normal" style="line-height:1.00; tabstops:none;"></para>
    <para styleclass="Normal" style="line-height:1.00; tabstops:none;"></para>
    <para styleclass="Normal" style="line-height:1.00; tabstops:none;">By writing it like this it is immediately clear that the implementation is quite different from the definition in the interface</para>
  </body>
</topic>
