<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../helpproject.xsl" ?>
<topic template="Default" modified="2024-07-26T12:07:31.891+08:00" lasteditedby="niuji" version="2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../helpproject.xsd">
  <title>匿名方法</title>
  <body>
    <header>
      <para styleclass="Heading1">匿名方法</para>
    </header>
    <para styleclass="Body Text"></para>
    <para styleclass="Body Text">匿名方法表达式 (AME) 示例(注意 DELEGATE 关键字)：</para>
    <para styleclass="Body Text"><br/>请注意，该表达式的主体可以是.AME：</para>
    <para styleclass="Body Text"></para>
    <list id="0" type="ol" listtype="decimal" formatstring="%0:s." format-charset="DEFAULT_CHARSET" levelreset="true" legalstyle="false" startfrom="1" styleclass="Body Text" style="font-family:Arial; font-size:11pt; color:#000000;">
      <li styleclass="Body Text">一个表达式</li>
      <li styleclass="Body Text">一个表达式列表</li>
      <li styleclass="Body Text">一个语句列表</li>
    </list>
    <para styleclass="Body Text"></para>
    <para styleclass="Body Text">前两种情况要求表达式与开头的大括号 <text style="font-weight:bold;">{</text> 在同一行。当然，您也可以使用语句续行符 ; 来告诉编译器您已将语句分散在多行中。</para>
    <para styleclass="Body Text"><br/>最后一种方法要求列表中的语句在不同的行上，结尾的 Curly <text style="font-weight:bold;">}</text> 也必须在不同的行上。这在下面的示例中可以看到。</para>
    <para styleclass="Body Text"></para>
    <para styleclass="Code Example"><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">USING</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> System.Windows.Forms</text><br/><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">FUNCTION</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> Start() </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">VOID</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">  </text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   TestAnonymous()</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">RETURN</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> </text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   </text><br/><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">FUNCTION</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> TestAnonymous() </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">VOID</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">LOCAL</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> oForm </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> Form</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   oForm := Form{}</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   oForm:Text := &quot;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">点击我 激活匿名方法</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&quot;</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   oForm:Click += DELEGATE(o </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> System.Object, e </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> System.EventArgs ) {  </text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">                  System.Windows.Forms.MessageBox.Show(&quot;Click 1!&quot;)    </text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">                  System.Windows.Forms.MessageBox.Show(&quot;Click 2!&quot;)   </text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">               }   </text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   oForm:ShowDialog()</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">RETURN</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">    </text></para>
  </body>
</topic>
