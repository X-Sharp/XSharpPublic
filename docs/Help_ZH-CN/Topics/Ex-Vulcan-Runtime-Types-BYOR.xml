<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../helpproject.xsl" ?>
<topic template="Default" modified="2024-07-26T12:07:31.976+08:00" lasteditedby="niuji" version="2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../helpproject.xsd">
  <title>Vulcan Runtime(BYOR)</title>
  <body>
    <header>
      <para styleclass="Heading1">Vulcan Runtime (BYOR)</para>
    </header>
    <para styleclass="Code Example"><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">这个 “自带运行时”(Bring Your Own Runtime--BYOR)示例展示了如何在 X# 中使用 Vulcan 数据类型和函数</text><br/><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">该示例不包含 Vulcan Runtime 动态链接库。您需要在机器上安装它。您可能需要更新示例中的引用，并将其指向你机器上的 Vulcan Runtime </text><br/><br/><text style="font-weight:bold; font-style:italic; text-decoration:none; color:#339966;">// 请阅读 Readme.txt 中的注释 !</text><br/><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">using</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> System</text><br/><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">using</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> System.Collections.Generic</text><br/><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">using</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> System.Linq</text><br/><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">using</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> System.Text</text><br/><br/><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">Function</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> Start() </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">as</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">void</text><br/><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">LOCAL</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> startingColor </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> ConsoleColor</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   startingColor := Console.ForegroundColor</text><br/><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   ConsoleHeading(&quot;自带运行时(BYOR)示例&quot;,ConsoleColor.Magenta)</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   Console.ForegroundColor := ConsoleColor.Gray</text><br/><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   DateSamples()</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   Conversion()</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   Strings()</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   Numeric()</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   Wait()</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   Arrays()</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   Symbols()</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   LateBinding()</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   Wait()</text><br/><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   Workarea()</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   Wait()</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   Macros()</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   Wait()</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   CodeBlocks()</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   Wait()</text><br/><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   Console.ForegroundColor := startingColor</text><br/><br/><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">FUNCTION</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> ConsoleHeading(s </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">STRING</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">, c := ConsoleColor.Yellow </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> ConsoleColor) </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">VOID</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">LOCAL</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> originalColor </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> ConsoleColor</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   originalColor := Console.ForegroundColor</text><br/><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   Console.ForegroundColor := c</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   Console.WriteLine(s)</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   Console.ForegroundColor := originalColor</text><br/><br/><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">FUNCTION</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> Wait() </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">VOID</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   ConsoleHeading(&quot;任意键继续...&quot;,ConsoleColor.Green)</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   Console.ReadKey()</text><br/><br/><br/><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">FUNCTION</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> DateSamples() </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">VOID</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   ConsoleHeading(&quot;Dates&quot;)</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">LOCAL</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> dToday := Today() </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">DATE</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> </text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   Console.WriteLine( i&quot;今天是 {dToday:d}&quot;   )   </text><text style="font-weight:bold; font-style:italic; text-decoration:none; color:#339966;">// 插值字符串，短日期格式</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   Console.WriteLine( i&quot;今天是 {dToday:G}&quot;   )   </text><text style="font-weight:bold; font-style:italic; text-decoration:none; color:#339966;">// 插值字符串，一般日期格式</text><br/><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">LOCAL</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> dTomorrow </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> __VODATE</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   dTomorrow := dToday + 1  </text><text style="font-weight:bold; font-style:italic; text-decoration:none; color:#339966;">// 可以执行 VO 日期运算</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   Console.WriteLine( i&quot;明天是 {dTomorrow:D}&quot;) </text><text style="font-weight:bold; font-style:italic; text-decoration:none; color:#339966;">// 长日期格式   </text><br/><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">LOCAL</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> dNewYear </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">DATE</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">    dNewYear := 2016.01.01</text><br/><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">    Console.WriteLine(&quot;New year was &quot; +AsString(dNewYear)+ &quot; on a &quot;+CDOW(dNewyear))</text><br/><br/><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">FUNCTION</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> Conversion() </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">VOID</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   ConsoleHeading(&quot;Conversion&quot;)</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">LOCAL</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> sToday </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">STRING</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   sToday := DTOS(Today()) </text><text style="font-weight:bold; font-style:italic; text-decoration:none; color:#339966;">// 使用 VO 函数转换日期</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   Console.WriteLine(i&quot;Today is {sToday}&quot;) </text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   </text><br/><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">FUNCTION</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> Strings() </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">VOID</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   ConsoleHeading(&quot;Strings&quot;)</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">LOCAL</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> s </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">STRING</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">LOCAL</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> sToday := DTOS(Today())</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   s := SubStr(sToday,1,4) </text><text style="font-weight:bold; font-style:italic; text-decoration:none; color:#339966;">// 字符串操作</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   Console.WriteLine(</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">String</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">.Format(&quot;SubStr is {0}&quot;,s))</text><br/><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">LOCAL</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> n </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">DWORD</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   n := At(&quot;0&quot;,s)</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   Console.WriteLine(</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">String</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">.Format(&quot;At is {0}&quot;,n))</text><br/><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">LOCAL</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> c := &quot;&quot; </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">STRING</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   Console.WriteLine(</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">String</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">.Format(&quot;c is {0}&quot;,IIF(Empty(c),&quot;Empty&quot;,&quot;Not empty&quot;)))</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   c := &quot;x&quot;</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   Console.WriteLine(</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">String</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">.Format(&quot;c is {0}&quot;,IIF(Empty(c),&quot;Empty&quot;,&quot;Not empty&quot;)))</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">RETURN</text><br/><br/><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">FUNCTION</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> Numeric() </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">as</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">VOID</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   ConsoleHeading(&quot;Numeric&quot;)</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">LOCAL</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> r </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">REAL8</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   r := Pow(2,3)</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   Console.WriteLine(</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">String</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">.Format(&quot;Pow is {0}&quot;,r))</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">LOCAL</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> f </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">FLOAT</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   f := Sqrt(10)</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   Console.WriteLine(</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">String</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">.Format(&quot;10 的根是 {0}&quot;,f))</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">RETURN</text><br/><br/><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">FUNCTION</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> Arrays() </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">VOID</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   ConsoleHeading(&quot;Array&quot;)</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">LOCAL</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> a </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">ARRAY</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   a := {1,2,3}</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   Console.WriteLine(</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">String</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">.Format(&quot;原始数组长度为 {0}&quot;,ALen(a)))</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   AAdd(a,4)</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   AAdd(a,5)</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   AAdd(a,6)</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   Console.WriteLine(</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">String</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">.Format(&quot;添加 3 个元素后的数组长度为 {0}&quot;,ALen(a)))</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">FOR</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">VAR</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> i := 1 </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">TO</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> ALen(a)</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">      Console.Writeline(</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">String</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">.Format(&quot;{0} {1}&quot;, i, a[i]))</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">NEXT</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   ADel(a, 1)</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   Asize(a, Alen(a) -1)</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   Console.WriteLine(</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">String</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">.Format(&quot;删除 1 个元素后的数组长度为 {0}&quot;,ALen(a)))</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">RETURN</text><br/><br/><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">FUNCTION</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> Symbols() </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">VOID</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">LOCAL</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> s </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">as</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">Symbol</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">LOCAL</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> c </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">as</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">STRING</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   ConsoleHeading(&quot;Symbol&quot;)</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   s := #LastName</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   Console.WriteLine(&quot;Symbol s: &quot;+s:ToString())</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   c := Symbol2String(s)</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   Console.WriteLine(&quot;Symbol 转换到 string : &quot;+c)</text><br/><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">RETURN</text><br/><br/><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">FUNCTION</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> LateBinding() </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">VOID</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">LOCAL</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> e </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">as</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> Object</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   ConsoleHeading(&quot;Late binding&quot;)</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   e := Error{0, &quot;Message&quot;}</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   Console.WriteLine(&quot;从未定义类型的变量中读取属性&quot;)</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   Console.WriteLine( (</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">String</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">) e:Message)</text><br/><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">RETURN</text><br/><br/><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">Function</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> Workarea() </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">VOID</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">LOCAL</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> cWorkDir </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">as</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">STRING</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   FIELD LASTNAME, FIRSTNAME </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">in</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> CUSTOMER</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   ConsoleHeading(&quot;DBF Access&quot;)</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   cWorkDir := &quot;..\..\&quot;</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   SetPath(cWorkDir)</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   DbUseArea(TRUE, &quot;DBFNTX&quot;,&quot;Customer&quot;)</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   DbSetIndex(&quot;CustNum.NTX&quot;)</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   DbSetIndex(&quot;CustName.NTX&quot;)</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   DbGoTop()</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">DO</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">WHILE</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> ! EOF()</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">      ? Str(Recno(),3), LASTNAME, FIRSTNAME, _FIELD-&gt;CITY</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">      DbSkip(1)</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">ENDDO</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   DbCloseArea()</text><br/><br/><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">FUNCTION</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> Macros() </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">VOID</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">LOCAL</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> cMacro </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">as</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">STRING</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">LOCAL</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> cbMacro </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">as</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> CodeBlock</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   ConsoleHeading(&quot;Macros&quot;)</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   cMacro := &quot;{||Today()}&quot;</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   cbMacro := &amp;(cMacro)</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   ? cMacro, Eval(cbMacro)</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   cMacro := &quot;1+2+3&quot;</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   ? cMacro, &amp;cMacro</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   cMacro := &quot;System.Int32.MaxValue&quot;</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   cbMacro := MCompile(cMacro)</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   ? cMacro, MExec(cbMacro)</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   cMacro := &quot;{|a,b,c| a*b*c}&quot;</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   cbMacro := &amp;(cMacro)</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   ? cMacro, Eval(cbMacro, 2,3,4)</text><br/><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   ?</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">RETURN</text><br/><br/><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">FUNCTION</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> CodeBlocks() </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">VOID</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">LOCAL</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> oBlock </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">as</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> CodeBlock</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   ConsoleHeading(&quot;Codeblocks&quot;)</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   oBlock := {||Today()}</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   ? oBlock, eval(oBlock)</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   oBlock := {||System.Math.Pow(2,3)}</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   ? oBlock, eval(oBlock)</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   oBlock := {|a,b,c|a*b*c}</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   ? oBlock, eval(oBlock,2,3,4)</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   ?</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">RETURN</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">   </text></para>
  </body>
</topic>
