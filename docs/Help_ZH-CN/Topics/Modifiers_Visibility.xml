<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../helpproject.xsl" ?>
<topic template="Default" modified="2024-07-26T10:05:24.021+08:00" lasteditedby="niuji" version="2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../helpproject.xsd">
  <title>可见性修饰符</title>
  <keywords>
    <keyword>EXPORT</keyword>
    <keyword>HIDDEN</keyword>
    <keyword>INTERNAL</keyword>
    <keyword>PRIVATE</keyword>
    <keyword>PROTECT</keyword>
    <keyword>PROTECTED</keyword>
    <keyword>PUBLIC</keyword>
    <keyword>STATIC</keyword>
  </keywords>
  <body>
    <header>
      <para styleclass="Heading1">可见性修饰符</para>
    </header>
    <para styleclass="Heading2">可见性修饰符</para>
    <para styleclass="Normal">访问修饰符限制程序元素的可见性：</para>
    <para styleclass="Normal"></para>
    <list id="0" type="ul" listtype="bullet" formatstring="&#183;" format-charset="SYMBOL_CHARSET" levelreset="true" legalstyle="false" startfrom="1" styleclass="Normal" style="font-family:Symbol; font-size:11pt; color:#000000;">
      <li styleclass="Normal">PUBLIC/EXPORT：公共函数、全局、类型(类、结构、委托等)或类型成员(字段、方法、属性、事件等)对声明它的同一程序集(exe 或 dll)中的所有代码以及声明程序集引用的程序集都是可见的。这是 X# 的默认设置。</li>
      <li styleclass="Normal">PROTECT/PROTECTED：PROTECT(ED)关键字只能应用于类型成员，并限制其在同一类型和继承自该类型的类的代码中的可见性。</li>
      <li styleclass="Normal">INSTANCE: X#(和 Visual Objects)独有的修饰符关键字，与 PROTECT 非常相似，但只适用于类字段，其语义与 PROTECT 不同，取决于同一类中的代码使用它的方式(请参阅下面的示例)。</li>
      <li styleclass="Normal">PRIVATE/HIDDEN：也适用于类型成员，但比 PROTECT 更严格，因为它限制了成员的可见性，只对声明该成员的类型内的代码可见（而不是对继承自该类型的类可见）。如果将一个字段或方法声明为 PRIVATE，当编译器检测到该字段或方法从未在类内被调用时，可能会产生编译器警告 &#160;<link displaytype="text" defaultstyle="true" type="topiclink" href="XS0169">xs0169</link>。</li>
      <li styleclass="Normal">INTERNAL：限制类型或成员的可见性，只对同一程序集(dll 或 exe)中的代码可见。内部成员对定义程序集之外的任何代码都不可见，甚至对其他程序集中声明的该类的继承类也不可见。可与 PROTECTED 结合使用，这样，INTERNAL PROTECTED 成员只能在同一类中看到，也可以从定义在同一程序集中的继承类中看到，但不能从定义在其他程序集中的继承类中看到。</li>
      <li styleclass="Normal"><text style="font-weight:bold;">XBase++</text> 方言也有修饰符 STATIC，这意味着类只能在使用它的源文件中可见。</li>
    </list>
    <para styleclass="Normal"></para>
    <para styleclass="Normal">注：通过使用 InternalsVisibleTo 属性，仍可明确指定某些程序集的内部类型和成员可见。更多信息，请参阅 System.Runtime.CompilerServices.InternalsVisibleToAttribute 文档。</para>
    <para styleclass="Code Example"><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">INTERNAL</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">PROCEDURE</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> InternalProc() </text><tab /><tab /><text style="font-weight:bold; font-style:italic; text-decoration:none; color:#339966;">// 程序只能在同一程序集内访问</text><br/><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">INTERNAL</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">GLOBAL</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> InternalGlobal </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">INT</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><tab /><tab /><text style="font-weight:bold; font-style:italic; text-decoration:none; color:#339966;">// 只能在同一程序集内访问的全局</text><br/><br/><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">PUBLIC</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">CLASS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> TestClass </text><tab /><tab /><tab /><tab /><text style="font-weight:bold; font-style:italic; text-decoration:none; color:#339966;">// 无处不在</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">EXPORT</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> Export_field </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">INT</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><tab /><tab /><tab /><text style="font-weight:bold; font-style:italic; text-decoration:none; color:#339966;">// 无处不在</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">PROTECT</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> Protected_field </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">INT</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><tab /><tab /><text style="font-weight:bold; font-style:italic; text-decoration:none; color:#339966;">// 本类及其继承的类可以访问</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">INTERNAL</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">PROTECT</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> Internal_Protected_field </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">INT</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:italic; text-decoration:none; color:#339966;">// 和继承自该类的类的访问权限，仅在同一程序集中定义</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">PRIVATE</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">METHOD</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> Private_Method() </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">VOID</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><tab /><text style="font-weight:bold; font-style:italic; text-decoration:none; color:#339966;">// 只能从该类的代码中访问</text><br/><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">END</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">CLASS</text></para>
    <para styleclass="Heading3">PROTECTED vs HIDDEN</para>
    <para styleclass="Normal">作为从 Visual Objects 派生的代码的兼容性功能，INSTANCE 适用于字段，与 PROTECT 类似，但在定义了同名属性(或 ACCESS)时具有不同的语义。当使用 PROTECT 字段并在类型中定义了同名的 ACCESS/ASSIGN 对(或属性)时，该类中任何试图访问该成员的代码都将始终引用该字段。但当使用 INSTANCE 关键字声明该成员时，编译器会将该名称与 ACCESS 绑定：</para>
    <para styleclass="Code Example"><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">FUNCTION</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> Start() </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">VOID</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; TestClass{}:DoTest()</text><br/><br/><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">CLASS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> TestClass</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">PROTECT</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> Protected_member := &quot;field&quot; </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">STRING</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">INSTANCE</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> Instance_member := &quot;field&quot; </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">STRING</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">ACCESS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> Protected_member </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">STRING</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">RETURN</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &quot;access&quot;</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">ACCESS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> Instance_member </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">STRING</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">RETURN</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &quot;access&quot;</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">METHOD</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> DoTest() </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">VOID</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; &#160; &#160;? </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">SELF</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">:Protected_member </text><text style="font-weight:bold; font-style:italic; text-decoration:none; color:#339966;">// field</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; &#160; &#160;? </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">SELF</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">:Instance_member </text><text style="font-weight:bold; font-style:italic; text-decoration:none; color:#339966;">// access, because the field is defined with the INSTANCE keyword</text><br/><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">END</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">CLASS</text></para>
    <para styleclass="Normal">该功能是旧 Visual Objects 版本遗留下来的，旧版本会为窗口编辑器中的每个控件生成 INSTANCE 成员，在 X# 中已被淘汰，但出于兼容性原因仍可使用。</para>
  </body>
</topic>
