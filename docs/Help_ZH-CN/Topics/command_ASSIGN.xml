<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../helpproject.xsl" ?>
<topic template="Default" modified="2024-07-26T10:54:35.920+08:00" lasteditedby="niuji" version="2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../helpproject.xsd">
  <title>ASSIGN 语句</title>
  <keywords>
    <keyword>ASSIGN statement</keyword>
    <keyword>Assign() Methods</keyword>
    <keyword>Compile-time declaration</keyword>
    <keyword>Declaration statements</keyword>
    <keyword>Entity declaration</keyword>
    <keyword>Instance variables<keyword>assigning values</keyword></keyword>
    <keyword>Methods<keyword>assigning values to instance variables</keyword></keyword>
    <keyword>Statements</keyword>
    <keyword>Strong typing<keyword>defined</keyword></keyword>
  </keywords>
  <body>
    <header>
      <para styleclass="Heading1">ASSIGN 语句</para>
    </header>
    <para styleclass="Heading1">用途</para>
    <para styleclass="Normal">声明一种为特定实例变量赋值的方法。</para>
    <para styleclass="Heading1">语法</para>
    <para styleclass="Normal"><tab />[Attributes] [Modifiers] <text style="font-weight:bold;">ASSIGN </text>&lt;<text styleclass="Italic">idVar</text>&gt;</para>
    <para styleclass="Normal"><tab />[([&lt;<text styleclass="Italic">idParam</text>&gt; [AS | REF &lt;<text styleclass="Italic">idType</text>&gt;] [, ...])] </para>
    <para styleclass="Normal"><tab />[AS &lt;<text styleclass="Italic">idType</text>&gt;] [&lt;<text styleclass="Italic">idConvention</text>&gt;]</para>
    <para styleclass="Normal"><tab />[CLASS &lt;<text styleclass="Italic">idClass</text>&gt;]</para>
    <para styleclass="Normal"><tab />[=&gt; &lt;expression&gt;]</para>
    <para styleclass="Normal"><tab /><text style="font-weight:bold;">CRLF</text></para>
    <para styleclass="Normal"><tab />[&lt;<text styleclass="Italic">Body</text>&gt;]</para>
    <para styleclass="Normal"><tab />[END ACCESS]</para>
    <para styleclass="Heading1">参数</para>
    <para styleclass="Normal"><snippet src="__IncludeMethodModifiers" inline="false"/></para>
    <para styleclass="List">&lt;idVar&gt;<tab />一个有效的实例变量标识符名称，您正在为其定义 assign 方法。 与其他方法一样，assign 方法也是实体；不过，系统为它们使用了独特的命名方案，以防止与其他实体名称相冲突。 在一个类中，ASSIGN 方法的名称必须是唯一的，但也可以与应用程序中的其他实体名称相同。</para>
    <para styleclass="List"></para>
    <para styleclass="List"><snippet src="__IncludeMethodParameters" inline="false"/></para>
    <para styleclass="List"><snippet src="__IncludeBody" inline="false"/></para>
    <para styleclass="List">END ASSIGN<tab />可选的结束语，表示 ASSIGN 实体的结束。</para>
    <para styleclass="Heading1">描述</para>
    <para styleclass="Normal">ASSIGN 声明了一个特殊的方法，称为赋值方法，每次为命名的实例变量赋值时都会自动执行(例如，&lt;idVar&gt; := &lt;uValue&gt;)。 赋值操作符右侧的值作为参数传递给 ASSIGN 方法。</para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal">在 CLASS 声明中可以定义四种类型的实例变量。 除了 EXPORT 之外，所有这些都被称为非导出(non-exported)实例变量，因为它们不能直接从外部(即类之外)访问。</para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal">例如，如果要在函数中为非导出变量(non-exported)赋值，就必须使用方法。 这意味着对实例变量赋值的接口取决于类的实现。 ASSIGN 方法为所有实例变量的赋值提供了通用语法。 与 ACCESS 方法(参见本指南中的 <link displaytype="text" defaultstyle="true" type="topiclink" href="command_ACCESS">ACCESS 语句</link>)结合使用，ASSIGN 方法可让你在应用程序中执行封装原则，同时保持稳定的类接口。</para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal">下面的示例说明了如何使用传统方法为非导出实例变量赋值。 请注意在 UseClass() 中为实例变量 x 和 y 赋值的不同之处：</para>
    <para styleclass="Code Example"><text style="font-weight:bold; font-style:normal; color:#ff0000;">CLASS</text><text style="font-weight:bold; font-style:normal; color:#000000;"> Test</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#ff0000;">EXPORT</text><text style="font-weight:bold; font-style:normal; color:#000000;"> x</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#ff0000;">INSTANCE</text><text style="font-weight:bold; font-style:normal; color:#000000;"> y</text><br/><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">METHOD</text><text style="font-weight:bold; font-style:normal; color:#000000;"> PutValueY</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">(</text><text style="font-weight:bold; font-style:normal; color:#000000;">nPut</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">)</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">CLASS</text><text style="font-weight:bold; font-style:normal; color:#000000;"> Test</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#000000;">y </text><text style="font-weight:bold; font-style:normal; color:#0000ff;">:=</text><text style="font-weight:bold; font-style:normal; color:#000000;"> nPut</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#ff0000;">RETURN</text><text style="font-weight:bold; font-style:normal; color:#000000;"> y</text><br/><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">FUNCTION</text><text style="font-weight:bold; font-style:normal; color:#000000;"> UseClass</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">()</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#ff0000;">LOCAL</text><text style="font-weight:bold; font-style:normal; color:#000000;"> oTest </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">AS</text><text style="font-weight:bold; font-style:normal; color:#000000;"> Test</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#000000;">oTest </text><text style="font-weight:bold; font-style:normal; color:#0000ff;">:=</text><text style="font-weight:bold; font-style:normal; color:#000000;"> Test</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">{}</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#0000ff;">?</text><text style="font-weight:bold; font-style:normal; color:#000000;"> oTest</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">:</text><text style="font-weight:bold; font-style:normal; color:#000000;">x </text><text style="font-weight:bold; font-style:normal; color:#0000ff;">:=</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">100</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#0000ff;">?</text><text style="font-weight:bold; font-style:normal; color:#000000;"> oTest</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">:</text><text style="font-weight:bold; font-style:normal; color:#000000;">PutValueY</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">(100)</text><tab /><text style="font-weight:bold; font-style:normal; color:#ff00ff;">// 使用常规方法</text></para>
    <para styleclass="Normal">如果将该方法替换为 assign 方法(如下所示)，对两个变量赋值的语法是相同的：</para>
    <para styleclass="Code Example"><text style="font-weight:bold; font-style:normal; color:#ff0000;">ASSIGN</text><text style="font-weight:bold; font-style:normal; color:#000000;"> y</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">(</text><text style="font-weight:bold; font-style:normal; color:#000000;">nPut</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">)</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">CLASS</text><text style="font-weight:bold; font-style:normal; color:#000000;"> Test</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#000000;">y </text><text style="font-weight:bold; font-style:normal; color:#0000ff;">:=</text><text style="font-weight:bold; font-style:normal; color:#000000;"> nPut</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#ff0000;">RETURN</text><text style="font-weight:bold; font-style:normal; color:#000000;"> y</text></para>
    <para styleclass="Code Example"><text style="font-weight:bold; font-style:normal; color:#ff0000;">FUNCTION</text><text style="font-weight:bold; font-style:normal; color:#000000;"> UseClass</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">()</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#ff0000;">LOCAL</text><text style="font-weight:bold; font-style:normal; color:#000000;"> oTest </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">AS</text><text style="font-weight:bold; font-style:normal; color:#000000;"> Test</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#000000;">oTest </text><text style="font-weight:bold; font-style:normal; color:#0000ff;">:=</text><text style="font-weight:bold; font-style:normal; color:#000000;"> Test</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">{}</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#0000ff;">?</text><text style="font-weight:bold; font-style:normal; color:#000000;"> oTest</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">:</text><text style="font-weight:bold; font-style:normal; color:#000000;">x </text><text style="font-weight:bold; font-style:normal; color:#0000ff;">:=</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">100</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#0000ff;">?</text><text style="font-weight:bold; font-style:normal; color:#000000;"> oTest</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">:</text><text style="font-weight:bold; font-style:normal; color:#000000;">y </text><text style="font-weight:bold; font-style:normal; color:#0000ff;">:=</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">100</text><tab /><tab /><text style="font-weight:bold; font-style:normal; color:#ff00ff;">// 使用 ASSIGN 方法</text></para>
    <para styleclass="Normal"><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">注意：ASSIGN 方法一般应返回实际赋值，以确保它所代表的假定变量实际上像一个变量--从技术上讲，赋值是关联的。 这样就可以像普通变量一样进行链式赋值（例如，Var2 := oTest1:y := oTest1:x := Var1 := 10000）。</text></para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal">非导出(non-exported)变量分为三类，每一类都有自己的属性(详见本指南中的 <link displaytype="text" defaultstyle="true" type="topiclink" href="command_CLASS">CLASS 语句</link>)：</para>
    <list id="0" type="ul" listtype="bullet" formatstring="&#183;" format-charset="SYMBOL_CHARSET" levelreset="true" legalstyle="false" startfrom="1" styleclass="Indented" style="text-align:left; text-indent:0px; margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:0px; line-height:1.00; background-color:transparent; white-space:normal; page-break-inside:auto; page-break-after:auto; border:none; tabstops:none; font-family:Symbol; font-size:11pt; color:#000000;">
      <li styleclass="Indented" style="text-align:left; text-indent:0px; margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:0px; line-height:1.00; background-color:transparent; white-space:normal; page-break-inside:auto; page-break-after:auto; border:none; tabstops:none;"><tab /><tab /><text styleclass="Normal">INSTANCE</text></li>
      <li styleclass="Indented" style="text-align:left; text-indent:0px; margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:0px; line-height:1.00; background-color:transparent; white-space:normal; page-break-inside:auto; page-break-after:auto; border:none; tabstops:none;"><tab /><tab /><text styleclass="Normal">PROTECT</text></li>
      <li styleclass="Indented" style="text-align:left; text-indent:0px; margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:0px; line-height:1.00; background-color:transparent; white-space:normal; page-break-inside:auto; page-break-after:auto; border:none; tabstops:none;"><tab /><tab /><text styleclass="Normal">HIDDEN</text></li>
    </list>
    <para styleclass="Normal"></para>
    <para styleclass="Normal">INSTANCE 变量是专门为 ASSIGN 和 ACCESS 方法而设计的，这也是其后期绑定的主要原因。 通过定义与 INSTANCE 变量同名的赋值方法，你可以有效地覆盖变量，使所有赋值引用(包括外部和内部引用)都调用 ASSIGN 方法。 例外情况是，在 ASSIGN(或 ACCESS)方法中，同名的实例变量会引用该变量--否则，你将一事无成。</para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal">您还可以将 PROTECT 和 HIDDEN 变量与 assign 方法结合使用。 通过定义与 PROTECT 或 HIDDEN 变量同名的 ASSIGN 方法，你可以使用与类内部相同的语法在外部对变量进行赋值。 然而，由于提前绑定的原因，内部引用总是直接引用变量。</para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal">当然，你不必给 ASSIGN 方法和实例变量起相同的名字。 这样做只是为了方便。 当您通过赋值访问 &lt;idVar&gt; 时，是由方法本身决定使用哪个实例变量名。 因此，对于 PROTECT/HIDDEN 变量，可以使用不同名称的 ASSIGN 方法。 例如</para>
    <para styleclass="Code Example"><text style="font-weight:bold; font-style:normal; color:#ff0000;">CLASS</text><text style="font-weight:bold; font-style:normal; color:#000000;"> Person</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#ff0000;">PROTECT</text><text style="font-weight:bold; font-style:normal; color:#000000;"> Name_Protected</text><br/><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">ASSIGN</text><text style="font-weight:bold; font-style:normal; color:#000000;"> Name</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">(</text><text style="font-weight:bold; font-style:normal; color:#000000;">cPutName</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">)</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">CLASS</text><text style="font-weight:bold; font-style:normal; color:#000000;"> Person</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#000000;">Name_Protected </text><text style="font-weight:bold; font-style:normal; color:#0000ff;">:=</text><text style="font-weight:bold; font-style:normal; color:#000000;"> cPutName</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#ff0000;">RETURN</text><text style="font-weight:bold; font-style:normal; color:#000000;"> Name_Protected</text></para>
    <para styleclass="Normal">与非导出(non-exported)变量和 ACCESS 方法相比，EXPORT 变量使用起来更快、更方便，但使用 EXPORT 变量却有悖于封装性，而封装性正是为提高应用程序的完整性而应努力实现的。 使用 ACCESS 方法和 ASSIGN 方法，你可以在应用程序原型设计的早期阶段使用 EXPORT 变量，之后在不改变类接口的情况下使用方法保护变量。</para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal">ACCESS 是 METHOD 的一种特例，除了调用方式(即不带参数，就像实例变量一样)外，其行为与其他方法相同。 更多详情，请参阅本指南中的 <link displaytype="text" defaultstyle="true" type="topiclink" href="command_METHOD">METHOD 语句</link> 。</para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal">注意：ACCESS 方法的内部引用如果没有相应的常规 INSTANCE 变量(例如，虚(拟)变量或对不同名称的 HIDDEN 或 PROTECT 变量的公共访问)，则必须使用 SELF: 前缀。 内部引用是指来自类或其子类方法内部的引用。 如果系统没有找到实例变量，则会假定是内存变量(这可能会导致编译器出错，具体取决于编译器设置中是否选择了 &quot;允许未声明变量&quot;)，除非使用了 SELF:，否则系统不会尝试将引用识别为 ACCESS 方法。</para>
    <para styleclass="Normal"><snippet src="__IncludeStrongTyping" inline="false"/></para>
    <para styleclass="Heading1">示例</para>
    <para styleclass="Normal">下面的示例使用 ASSIGN 建立了一个公共协议，用于对 INSTANCE 变量进行赋值：</para>
    <para styleclass="Code Example"><text style="font-weight:bold; font-style:normal; color:#ff0000;">CLASS</text><text style="font-weight:bold; font-style:normal; color:#000000;"> Rectangle</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#ff0000;">INSTANCE</text><text style="font-weight:bold; font-style:normal; color:#000000;"> Length</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">,</text><text style="font-weight:bold; font-style:normal; color:#000000;"> Height </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">AS</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">INT</text><br/><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">ASSIGN</text><text style="font-weight:bold; font-style:normal; color:#000000;"> Length</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">(</text><text style="font-weight:bold; font-style:normal; color:#000000;">nX</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">)</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">CLASS</text><text style="font-weight:bold; font-style:normal; color:#000000;"> Rectangle</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#000000;">Length </text><text style="font-weight:bold; font-style:normal; color:#0000ff;">:=</text><text style="font-weight:bold; font-style:normal; color:#000000;"> nX</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#ff0000;">RETURN</text><text style="font-weight:bold; font-style:normal; color:#000000;"> Length</text><br/><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">ASSIGN</text><text style="font-weight:bold; font-style:normal; color:#000000;"> Height</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">(</text><text style="font-weight:bold; font-style:normal; color:#000000;">nY</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">)</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">CLASS</text><text style="font-weight:bold; font-style:normal; color:#000000;"> Rectangle</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#000000;">Height </text><text style="font-weight:bold; font-style:normal; color:#0000ff;">:=</text><text style="font-weight:bold; font-style:normal; color:#000000;"> nY</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#ff0000;">RETURN</text><text style="font-weight:bold; font-style:normal; color:#000000;"> Height</text><br/><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">FUNCTION</text><text style="font-weight:bold; font-style:normal; color:#000000;"> UseClass</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">()</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#ff0000;">LOCAL</text><text style="font-weight:bold; font-style:normal; color:#000000;"> oShape </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">AS</text><text style="font-weight:bold; font-style:normal; color:#000000;"> Rectangle</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#000000;">oShape </text><text style="font-weight:bold; font-style:normal; color:#0000ff;">:=</text><text style="font-weight:bold; font-style:normal; color:#000000;"> Rectangle</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">{}</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#000000;">oShape</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">:</text><text style="font-weight:bold; font-style:normal; color:#000000;">Length </text><text style="font-weight:bold; font-style:normal; color:#0000ff;">:=</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">3</text><br/><tab /><text style="font-weight:bold; font-style:normal; color:#000000;">oShape</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">:</text><text style="font-weight:bold; font-style:normal; color:#000000;">Height </text><text style="font-weight:bold; font-style:normal; color:#0000ff;">:=</text><text style="font-weight:bold; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#0000ff;">4a</text></para>
    <para styleclass="Heading1">参见</para>
    <para styleclass="Normal"><link displaytype="text" defaultstyle="true" type="topiclink" href="command_ACCESS">ACCESS</link>, <link displaytype="text" defaultstyle="true" type="topiclink" href="command_CLASS">CLASS</link>, <link displaytype="text" defaultstyle="true" type="topiclink" href="command_METHOD">METHOD</link>, <link displaytype="text" defaultstyle="true" type="topiclink" href="command_PROPERTY">PROPERTY</link></para>
  </body>
</topic>
