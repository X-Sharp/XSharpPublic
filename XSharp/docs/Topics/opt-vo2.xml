<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../helpproject.xsl" ?>
<topic template="Default" lasteditedby="robert" version="2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../helpproject.xsd">
  <title>-vo2</title>
  <keywords>
    <keyword>-vo2</keyword>
  </keywords>
  <body>
    <header>
      <para styleclass="Heading1">-vo2<tab /><tab />Initialize strings </para>
    </header>
    <para styleclass="Normal">The -vo2 option directs the compiler to initialize all variables and fields of type STRING (System.String) and all elements of DIM ... AS STRING arrays to an empty string (/vo2[+|-]</para>
    <para styleclass="Heading2">Syntax</para>
    <para styleclass="Code with box">-vo2[+ | -] <text styleclass="Normal">&#32;</text></para>
    <para styleclass="Heading2">Arguments</para>
    <para styleclass="List">+ | - <tab />Specifying +, or just -vo2, directs the compiler to initialize all variables and fields of type STRING and all elements of DIM ... AS STRING arrays to an empty string (String.Empty). </para>
    <para styleclass="Heading2">Remarks</para>
    <para styleclass="Normal">This option is off by default, and all locals, globals, fields and array elements of type STRING have an initial value of NULL, which is the default initial value for any local, global, field or array element that contains a reference type.</para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal">Generally you will initialize a string variable to a specific value before it is used, and initializing it to an empty string would incur unnecessary overhead. In addition, it is inconsistent with the behavior of all other reference types, which have an initial value of NULL. However, this may break existing Visual Objects code that relies on Visual Object&apos;s behavior of initializing string variables to a string with zero characters.</para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal">When this option is not used, you may test for an empty string variable, field or array element by comparing it against NULL. When this option is enabled, you may test for an empty string variable, field or array element by comparing it against &quot;&quot; or String.Empty, or testing that its length equals zero. System.String.IsNullOrEmpty() may also be used to test whether a string variable contains NULL or a valid string with zero characters.</para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal">Also note that the predefined constant NULL_STRING is normally equivalent to NULL, but when -vo2 is used, NULL_STRING is equivalent to &quot;&quot; (a zero-length string).</para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal"> Compatibility Note: </para>
    <para styleclass="Normal">-vo2 does not initialize STRING fields in structures. Since structures do not have default constructors, structure fields cannot have initializer expressions. Although this is not a compatiblity issue since you cannot create structures (value types) in Visual Objects, it is something to keep in mind if you use structures in an application that uses -vo2.</para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal">Note that the use of the term &quot;structure&quot; here refers to STRUCTURE in X#, not STRUCTURE in Visual Objects, which has been renamed VOSTRUCT in X#. -vo2 has no effect on VOSTRUCT since you cannot declare fields that are reference types in a VOSTRUCT.</para>
    <para styleclass="Heading3"><snippet src="__VsDialect" inline="false"/></para>
    <para styleclass="Heading2">Example</para>
    <para styleclass="Code Example"><text style="font-weight:bold; font-style:italic; color:#339966;">// using default or /vo2-</text><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">FUNCTION</text><text style="font-weight:normal; font-style:normal; color:#000000;"> Start() </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">VOID</text><br/><text style="font-weight:normal; font-style:normal; color:#000000;"> &#160; </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">LOCAL</text><text style="font-weight:normal; font-style:normal; color:#000000;"> s </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">STRING</text><br/><text style="font-weight:normal; font-style:normal; color:#000000;"> &#160; ? s == </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">NULL</text><text style="font-weight:normal; font-style:normal; color:#000000;"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; </text><text style="font-weight:bold; font-style:italic; color:#339966;">// true</text><br/><text style="font-weight:normal; font-style:normal; color:#000000;"> &#160; ? s == &quot;&quot; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; </text><text style="font-weight:bold; font-style:italic; color:#339966;">// false</text><br/><text style="font-weight:normal; font-style:normal; color:#000000;"> &#160; ? s == </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">String</text><text style="font-weight:normal; font-style:normal; color:#000000;">.Empty &#160; &#160; &#160; </text><text style="font-weight:bold; font-style:italic; color:#339966;">// false</text><br/><text style="font-weight:normal; font-style:normal; color:#000000;"> &#160; ? Len(a) &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;</text><text style="font-weight:bold; font-style:italic; color:#339966;">// runtime error - NullReferenceException</text><br/><text style="font-weight:normal; font-style:normal; color:#000000;"> &#160; ? a:Length &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;</text><text style="font-weight:bold; font-style:italic; color:#339966;">// runtime error - NullReferenceException</text><br/><text style="font-weight:normal; font-style:normal; color:#000000;"> &#160; ? </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">String</text><text style="font-weight:normal; font-style:normal; color:#000000;">.IsNullOrEmpty(a) </text><text style="font-weight:bold; font-style:italic; color:#339966;">// true</text><br/><text style="font-weight:normal; font-style:normal; color:#000000;"> &#160; </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">RETURN</text></para>
    <para styleclass="Code Example"><text style="font-weight:bold; font-style:italic; color:#339966;">// using /vo2 or /vo2+</text><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">FUNCTION</text><text style="font-weight:normal; font-style:normal; color:#000000;"> Start() </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">VOID</text><br/><text style="font-weight:normal; font-style:normal; color:#000000;"> &#160; </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">LOCAL</text><text style="font-weight:normal; font-style:normal; color:#000000;"> s </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">STRING</text><text style="font-weight:normal; font-style:normal; color:#000000;"> &#160; &#160; &#160; &#160; </text><text style="font-weight:bold; font-style:italic; color:#339966;">// this compiles as &apos;LOCAL s := &quot;&quot; AS STRING&apos;</text><br/><text style="font-weight:normal; font-style:normal; color:#000000;"> &#160; ? s == </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">NULL</text><text style="font-weight:normal; font-style:normal; color:#000000;"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; </text><text style="font-weight:bold; font-style:italic; color:#339966;">// false</text><br/><text style="font-weight:normal; font-style:normal; color:#000000;"> &#160; ? s == &quot;&quot; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; </text><text style="font-weight:bold; font-style:italic; color:#339966;">// true</text><br/><text style="font-weight:normal; font-style:normal; color:#000000;"> &#160; ? s == </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">String</text><text style="font-weight:normal; font-style:normal; color:#000000;">.Empty &#160; &#160; &#160; </text><text style="font-weight:bold; font-style:italic; color:#339966;">// true</text><br/><text style="font-weight:normal; font-style:normal; color:#000000;"> &#160; ? Len(a) &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;</text><text style="font-weight:bold; font-style:italic; color:#339966;">// 0</text><br/><text style="font-weight:normal; font-style:normal; color:#000000;"> &#160; ? a:Length &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;</text><text style="font-weight:bold; font-style:italic; color:#339966;">// 0</text><br/><text style="font-weight:normal; font-style:normal; color:#000000;"> &#160; ? </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">String</text><text style="font-weight:normal; font-style:normal; color:#000000;">.IsNullOrEmpty(a) </text><text style="font-weight:bold; font-style:italic; color:#339966;">// true</text><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">RETURN</text></para>
    <para styleclass="Normal"></para>
  </body>
</topic>
