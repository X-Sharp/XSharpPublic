<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../helpproject.xsl" ?>
<topic template="Default" modified="2024-06-29T21:25:14.107+08:00" lasteditedby="niuji" version="2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../helpproject.xsd">
  <title>BEGIN SEQUENCE 语句</title>
  <keywords>
    <keyword>BEGIN SEQUENCE statement</keyword>
    <keyword>Branching</keyword>
    <keyword>BREAK statement</keyword>
    <keyword>END SEQUENCE statement</keyword>
    <keyword>Program control</keyword>
    <keyword>RECOVER statement</keyword>
    <keyword>RECOVER USING statement</keyword>
    <keyword>Statements</keyword>
  </keywords>
  <body>
    <header>
      <para styleclass="Heading1">BEGIN SEQUENCE 语句</para>
    </header>
    <para styleclass="Heading1">用途</para>
    <para styleclass="Normal">为 BREAK 定义一系列语句。</para>
    <para styleclass="Heading1">语法</para>
    <para styleclass="Code with box">BEGIN SEQUENCE<br/><tab />&lt;Statements&gt;...<br/>[BREAK [&lt;uValue&gt;]]<br/><tab />&lt;Statements&gt;... &#160;<br/>[RECOVER [USING &lt;idVar&gt;]]<br/><tab />&lt;Statements&gt;...<br/>END [SEQUENCE]</para>
    <para styleclass="Heading1">参数</para>
    <para styleclass="List">BREAK &lt;uValue&gt;<tab />如果指定了最近的 RECOVER 语句或最近的 END SEQUENCE 语句，则将执行分支到紧随其后的语句。 &lt;uValue&gt; 是返回到 RECOVER 语句的 USING 子句中指定的 &lt;idVar&gt; 中的值。</para>
    <para styleclass="List"></para>
    <para styleclass="List">RECOVER USING &lt;idVar&gt;</para>
    <para styleclass="List"><tab />SEQUENCE 结构中的恢复点，在 BREAK 语句后，控制将在此点分支。 如果指定了该子句，&lt;idVar&gt; 将接收 BREAK 语句返回的值。 一般来说，这是一个错误对象。 &lt;idVar&gt; 必须是已声明的变量，并且不能是强类型变量。</para>
    <para styleclass="List"></para>
    <para styleclass="List">END<tab />SEQUENCE 控制结构的终点。 如果没有指定 RECOVER 语句，则在 BREAK 后将执行 END 语句之后的第一条语句。</para>
    <para styleclass="Heading1">描述</para>
    <para styleclass="Normal"><text style="font-weight:bold;">BEGIN SEQUENCE...END </text>是一种控制结构，用于异常和运行时错误处理。 它限定了一个定义离散操作的语句块，包括调用的存储过程和函数。 除<text style="font-weight:bold;"> BREAK </text>语句外，整个结构必须属于同一实体定义。</para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal">当在 <text style="font-weight:bold;">BEGIN SEQUENCE </text>语句到相应的 <text style="font-weight:bold;">RECOVER </text>语句之后的语句块中的任何地方遇到 &quot;中断&quot;(<text style="font-weight:bold;">BREAK) </text>时，控制将分支到紧跟在<text style="font-weight:bold;"> RECOVER </text>语句之后的程序语句。 如果没有指定 <text style="font-weight:bold;">RECOVER </text>语句，控制将分支到<text style="font-weight:bold;"> END </text>语句之后的语句，从而终止<text style="font-weight:bold;"> SEQUENCE。 </text>如果控制到达<text style="font-weight:bold;"> RECOVER </text>语句时没有遇到<text style="font-weight:bold;"> BREAK，</text>则分支到相应的<text style="font-weight:bold;"> END </text>语句之后的语句。</para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal"><text style="font-weight:bold;">RECOVER </text>语句可选择接收<text style="font-weight:bold;"> BREAK </text>语句传递的参数，该参数指定了返回值。 这通常是一个错误对象，由 ErrorBlock() 定义的当前错误处理块生成并返回。 如果返回了错误对象，则可以向其发送信息，以查询有关错误的信息。 有了这些信息，运行时错误就可以在操作的上下文中处理，而不是在当前的运行时错误处理程序中处理。</para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal">在<text style="font-weight:bold;"> BEGIN SEQUENCE </text>和<text style="font-weight:bold;"> RECOVER </text>语句之间不能使用<text style="font-weight:bold;"> RETURN、LOOP </text>或<text style="font-weight:bold;"> EXIT。</text></para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal">控制结构可以嵌套到任意深度。 唯一的要求是每个控制结构都必须正确嵌套。</para>
    <para styleclass="Heading1">示例</para>
    <para styleclass="Normal">该代码片段演示了一个 <text style="font-weight:bold;">SEQUENCE</text> 结构，其中的 BREAK 发生在当前过程中：</para>
    <para styleclass="Code Example"><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">BEGIN</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">SEQUENCE</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; &lt;Statements&gt;...</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">IF</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> lBreakCond</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; &#160; &#160;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">BREAK</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">ENDIF</text><br/><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">RECOVER</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; &lt;Recovery Statements&gt;...</text><br/><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">END</text><br/><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&lt;Recovery Statements&gt;...</text></para>
    <para styleclass="Normal">此示例演示了一个错误处理程序，它将向 RECOVER 语句的 USING 子句中指定的变量返回一个错误对象：</para>
    <para styleclass="Code Example"><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">LOCAL</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> oLocal, bLastHandler</text><br/><text style="font-weight:bold; font-style:italic; text-decoration:none; color:#339966;">// 保存当前错误处理程序，并设置新的错误处理程序</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">bLastHandler := ErrorBlock({|oErr| ;</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; &#160; &#160;MyHandler(oErr, TRUE)})</text><br/><br/><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">BEGIN</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">SEQUENCE</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; .</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; . &#160;&lt;可能失败的操作&gt;...</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; .</text><br/><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">RECOVER</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">USING</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> oLocal</text><br/><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; </text><text style="font-weight:bold; font-style:italic; text-decoration:none; color:#339966;">// 向 oLocal 发送信息并处理错误</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; ? &quot;Error: &#160;&quot;</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">IF</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> oLocal:GenCode != 0</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; &#160; &#160;?? oLocal:Description</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">ENDIF</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; .</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; . &#160;</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; .</text><br/><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">END</text><br/><br/><text style="font-weight:bold; font-style:italic; text-decoration:none; color:#339966;">// 恢复先前的错误处理程序</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">ErrorBlock(bLastHandler)</text><br/><br/><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">FUNCTION</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> MyHandler(oError, lLocalHandler)</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; </text><text style="font-weight:bold; font-style:italic; text-decoration:none; color:#339966;">// 返回错误对象的本地处理</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">IF</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> lLocalHandler</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; &#160; &#160;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">BREAK</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> oError</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">ENDIF</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; </text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; &lt;处理错误的其他语句&gt;...</text></para>
    <para styleclass="Normal">此示例通过在 <text style="font-weight:bold;">RECOVER</text> 语句块内发出 <text style="font-weight:bold;">LOOP</text>，重新执行 <text style="font-weight:bold;">SEQUENCE</text> 语句块：</para>
    <para styleclass="Code Example"><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">DO</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">WHILE</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> TRUE</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">BEGIN</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">SEQUENCE</text><br/><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; &#160; &#160;&lt;可能失败的操作&gt;...</text><br/><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">RECOVER</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; &#160; &#160;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">IF</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> PrintRecover()</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; &#160; &#160; &#160; &#160; &#160;</text><text style="font-weight:bold; font-style:italic; text-decoration:none; color:#339966;">// 重复 SEQUENCE 语句块</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; &#160; &#160; &#160; </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">LOOP</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; &#160; &#160;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">ENDIF</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">END</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">EXIT</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; &#160; &#160; &#160; </text><text style="font-weight:bold; font-style:italic; text-decoration:none; color:#339966;">// 逃离行动现场</text><br/><br/><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">ENDDO</text></para>
    <para styleclass="Heading1">参见</para>
    <para styleclass="Normal"><link displaytype="text" defaultstyle="true" type="topiclink" href="html\M_XSharp_RT_Functions__Break.htm" domain="XSharpRef.chm">_Break()</link>, <link displaytype="text" defaultstyle="true" type="topiclink" href="html\M_XSharp_RT_Functions_CanBreak.htm" domain="XSharpRef.chm">CanBreak()</link>, <link displaytype="text" defaultstyle="true" type="topiclink" href="html\T_XSharp_Error.htm" domain="XSharpRef.chm">Error Class</link>, <link displaytype="text" defaultstyle="true" type="topiclink" href="html\M_XSharp_RT_Functions_ErrorBlock.htm" domain="XSharpRef.chm">ErrorBlock()</link>, <link displaytype="text" defaultstyle="true" type="topiclink" href="command_RETURN">RETURN</link></para>
    <para styleclass="Normal"></para>
  </body>
</topic>
