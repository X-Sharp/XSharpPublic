<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../helpproject.xsl" ?>
<topic template="Default" modified="2024-06-14T20:52:49.225+08:00" lasteditedby="Design" version="2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../helpproject.xsd">
  <title>_DLL Statement</title>
  <keywords>
    <keyword>_DLL statement</keyword>
    <keyword>Compile-time declaration</keyword>
    <keyword>Declaration statements</keyword>
    <keyword>DLLs<keyword>declaring</keyword></keyword>
    <keyword>Dynamic linking</keyword>
    <keyword>Entity declaration</keyword>
    <keyword>Statements</keyword>
  </keywords>
  <body>
    <header>
      <para styleclass="Heading1">_DLL Statement</para>
    </header>
    <para styleclass="Heading1">用途</para>
    <para styleclass="Body Text">向编译器声明 DLL 中定义的实体。</para>
    <para styleclass="Heading1">语法</para>
    <para styleclass="Code with box"><tab />[Attributes] [Modifiers] _DLL FUNCTION | PROCEDURE<br/><tab />[([&lt;idParam&gt; [AS | REF &lt;idType&gt;] [, ...])] <br/><tab />[AS &lt;idType&gt;]<br/><tab />[&lt;idConvention&gt;]<br/><tab />:&lt;idDLL&gt;.&lt;idEntity&gt;<br/><tab />[CharSet= AUTO|ANSI|UNICODE]</para>
    <para styleclass="Code with box"><text styleclass="Heading1">参数</text></para>
    <para styleclass="List">&lt;idEntity&gt;<tab />DLL 中定义的实体名称或编号。 这通常与 &lt;EntityDeclaration&gt; 中定义的实体名称相同，但不一定，后者可能定义了实体在应用程序中的别名。 &lt;idEntity&gt; 必须是由 &lt;idDLL&gt; 标识的 DLL 公共协议的一部分。</para>
    <para styleclass="List"><tab />IdEntity 也可以指定为字面量字符串。这样做是为了指定 DLL 中导出函数的名称，这些名称包含的字符在 X# 中不允许作为标识符的一部分。</para>
    <para styleclass="List"></para>
    <para styleclass="List"><snippet src="__IncludeParameters" inline="false"/></para>
    <para styleclass="Normal"><snippet src="__callingconvention" inline="false"/></para>
    <para styleclass="List">&lt;idDLL&gt;<tab />包含实体定义的 DLL 文件名，不含扩展名或路径名（即基本文件名）。 假定扩展名为 .DLL（由 Windows 决定的某些例外情况可能有 .EXE 扩展名），用于在运行时搜索文件的规则将在下文的 &quot;描述&quot;部分解释。</para>
    <para styleclass="List"></para>
    <para styleclass="List"><text styleclass="Body Text">Charset</text><tab /><text styleclass="Body Text">可选择指定字符串参数具有哪些字符集</text></para>
    <para styleclass="Heading1">描述</para>
    <para styleclass="Body Text">_DLL 声明了一个实体，该实体由应用程序使用，但定义在 DLL 中。 该语句不仅告诉编译器 DLL 实体的位置和名称（或编号），而且还告诉编译器它的调用约定（即它需要哪些参数以及返回值的类型）。 使用 _DLL 语句声明实体时，它还向编译器表明，该实体在声明之后没有其他源代码。</para>
    <para styleclass="Body Text">一旦声明，就可以在应用程序中以标准方式调用该实体。</para>
    <para styleclass="Body Text"></para>
    <para styleclass="Body Text">警告： &#160;_DLL 语句中包含的实体名称区分大小写。这与 X# 编译器直接矛盾，后者不区分大小写，但与 Windows 调用协议一致。因此，如果开启了大小写敏感功能或打开了大写锁定，则必须格外小心。</para>
    <para styleclass="Heading1">示例</para>
    <para styleclass="Normal">下面的示例说明了两个 Windows API 函数的 _DLL 声明：</para>
    <para styleclass="Code Example"><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">_DLL</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">FUNCTION</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> MessageBeep(siLevel </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">SHORTINT</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">) </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">VOID</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> PASCAL:User.MessageBeep</text><br/><br/><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">_DLL</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">FUNCTION</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> MessageBox(hwndParent </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">PTR</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">, pszText </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">PSZ</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">, &#160;pszCapt </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">PSZ</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">, dwFlags </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">DWORD</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">) ;</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">LONG</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> PASCAL:User.MessageBox</text><br/><text style="font-weight:bold; font-style:italic; text-decoration:none; color:#339966;">// 如果需要，您也可以声明一个带有 &quot;普通 &quot;字符串参数的函数。添加 ANSI 或 UNICODE 子句来指明您要调用的版本。</text><br/><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">_DLL</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">FUNCTION</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> MessageBox(hwndParent </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">PTR</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">, pszText </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">STRING</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">, &#160;pszCapt </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">STRING</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">, dwFlags </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">DWORD</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">) ;</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">LONG</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> PASCAL:User.MessageBox </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">ANSI</text></para>
    <para styleclass="Heading1">参见</para>
    <para styleclass="Normal"><link displaytype="text" defaultstyle="true" type="topiclink" href="command_ACCESS" styleclass="link" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">ACCESS</link><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="command_ASSIGN" styleclass="link" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">ASSIGN</link><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="command_FUNCTION">FUNCTION</link><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="command_METHOD">METHOD</link><text styleclass="Bold" style="font-family:Arial; font-size:10pt; font-weight:normal; font-style:normal; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="command_PROCEDURE">PROCEDURE</link></para>
    <para styleclass="Normal"></para>
  </body>
</topic>
