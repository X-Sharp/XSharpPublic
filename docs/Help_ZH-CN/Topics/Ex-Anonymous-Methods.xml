<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../helpproject.xsl" ?>
<topic template="Default" modified="2025-03-31T12:33:42.050+08:00" lasteditedby="niuji" version="2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../helpproject.xsd">
  <title>匿名方法</title>
  <body>
    <header>
      <para styleclass="Heading1">匿名方法</para>
    </header>
    <para styleclass="Body Text"></para>
    <para styleclass="Body Text">匿名方法表达式 (AME：<text styleclass="f_bodytext" style="font-family:&apos;Times New Roman&apos;; font-size:12pt; font-weight:normal; font-style:normal; text-decoration:none; text-transform:none; vertical-align:baseline; color:#000000; background-color:transparent; letter-spacing:normal; letter-scaling:100%;">Anonymous Method Expression</text>) 示例(注意 DELEGATE 关键字)：</para>
    <para styleclass="Body Text"><br/>请注意，该表达式的主体可以是.AME：</para>
    <para styleclass="Body Text"></para>
    <list id="0" type="ol" listtype="decimal" formatstring="&#37;&#48;&#58;&#115;&#46;" format-charset="DEFAULT_CHARSET" levelreset="true" legalstyle="false" startfrom="1" styleclass="Body Text" style="font-family:Arial; font-size:11pt; color:#000000;">
      <li styleclass="Body Text">一个表达式</li>
      <li styleclass="Body Text">一个表达式列表</li>
      <li styleclass="Body Text">一个语句列表</li>
    </list>
    <para styleclass="Body Text"></para>
    <para styleclass="Body Text">前两种情况要求表达式与开头的大括号 <text style="font-weight:bold;">{</text> 在同一行。当然，您也可以使用语句续行符 ; 来告诉编译器您已将语句分散在多行中。</para>
    <para styleclass="Body Text"><br/>最后一种方法要求列表中的语句在不同的行上，结尾的 <text style="font-weight:bold;">}</text> 也必须在不同的行上。这在下面的示例中可以看到。</para>
    <para styleclass="Body Text"></para>
    <para styleclass="Code Example"><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">USING</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> System.Windows.Forms</text><br/><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">FUNCTION</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> Start() </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">VOID</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160;</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; TestAnonymous()</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">RETURN</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; </text><br/><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">FUNCTION</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> TestAnonymous() </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">VOID</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">LOCAL</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> oForm </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> Form</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; oForm := Form{}</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; oForm:Text := &quot;</text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">点击窗体激活匿名方法</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">&quot;</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; oForm:Click += DELEGATE(o </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> System.Object, e </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> System.EventArgs ) { &#160;</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;System.Windows.Forms.MessageBox.Show(&quot;Click 1!&quot;) &#160; &#160;</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;System.Windows.Forms.MessageBox.Show(&quot;Click 2!&quot;) &#160; </text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; } &#160; </text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; oForm:ShowDialog()</text><br/><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; </text><text style="font-weight:bold; font-style:normal; text-decoration:none; color:#ff0000;">RETURN</text><text style="font-weight:normal; font-style:normal; text-decoration:none; color:#000000;"> &#160; &#160;</text></para>
    <para styleclass="Code Example"><text style="font-family:Arial; font-weight:normal; font-style:normal; text-decoration:none; color:#000000;">附：Foxpro 方言示例：</text></para>
    <para styleclass="" style="text-align:left; text-indent:0px; margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:26px; line-height:1.00; background-color:transparent; white-space:normal; page-break-inside:auto; page-break-after:auto; border:none; tabstops:none;"><text styleclass="" style="font-family:Consolas; font-size:11pt; color:#0000ff; background-color:#ffffff;">Using</text><text styleclass="" style="font-family:Consolas; font-size:11pt; color:#000000; background-color:#ffffff;"> System.Windows.Forms</text></para>
    <para styleclass="" style="text-align:left; text-indent:0px; margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:26px; line-height:1.00; background-color:transparent; white-space:normal; page-break-inside:auto; page-break-after:auto; border:none; tabstops:none;"></para>
    <para styleclass="" style="text-align:left; text-indent:0px; margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:26px; line-height:1.00; background-color:transparent; white-space:normal; page-break-inside:auto; page-break-after:auto; border:none; tabstops:none;"><text styleclass="" style="font-family:Consolas; font-size:11pt; color:#0000ff; background-color:#ffffff;">Function</text><text styleclass="" style="font-family:Consolas; font-size:11pt; color:#000000; background-color:#ffffff;"> Start() </text><text styleclass="" style="font-family:Consolas; font-size:11pt; color:#0000ff; background-color:#ffffff;">As</text><text styleclass="" style="font-family:Consolas; font-size:11pt; color:#000000; background-color:#ffffff;">&#32;</text><text styleclass="" style="font-family:Consolas; font-size:11pt; color:#0000ff; background-color:#ffffff;">Void</text></para>
    <para styleclass="" style="text-align:left; text-indent:0px; margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:26px; line-height:1.00; background-color:transparent; white-space:normal; page-break-inside:auto; page-break-after:auto; border:none; tabstops:none;"><text styleclass="" style="font-family:Consolas; font-size:11pt; color:#000000; background-color:#ffffff;"> &#160; &#160;TestAnonymous()</text></para>
    <para styleclass="" style="text-align:left; text-indent:0px; margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:26px; line-height:1.00; background-color:transparent; white-space:normal; page-break-inside:auto; page-break-after:auto; border:none; tabstops:none;"><text styleclass="" style="font-family:Consolas; font-size:11pt; color:#000000; background-color:#ffffff;"> &#160; &#160;</text><text styleclass="" style="font-family:Consolas; font-size:11pt; color:#0000ff; background-color:#ffffff;">Return</text></para>
    <para styleclass="" style="text-align:left; text-indent:0px; margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:26px; line-height:1.00; background-color:transparent; white-space:normal; page-break-inside:auto; page-break-after:auto; border:none; tabstops:none;"><text styleclass="" style="font-family:Consolas; font-size:11pt; color:#0000ff; background-color:#ffffff;">End</text><text styleclass="" style="font-family:Consolas; font-size:11pt; color:#000000; background-color:#ffffff;">&#32;</text><text styleclass="" style="font-family:Consolas; font-size:11pt; color:#0000ff; background-color:#ffffff;">Function</text></para>
    <para styleclass="" style="text-align:left; text-indent:0px; margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:26px; line-height:1.00; background-color:transparent; white-space:normal; page-break-inside:auto; page-break-after:auto; border:none; tabstops:none;"></para>
    <para styleclass="" style="text-align:left; text-indent:0px; margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:26px; line-height:1.00; background-color:transparent; white-space:normal; page-break-inside:auto; page-break-after:auto; border:none; tabstops:none;"><text styleclass="" style="font-family:Consolas; font-size:11pt; color:#0000ff; background-color:#ffffff;">Function</text><text styleclass="" style="font-family:Consolas; font-size:11pt; color:#000000; background-color:#ffffff;"> TestAnonymous() </text><text styleclass="" style="font-family:Consolas; font-size:11pt; color:#0000ff; background-color:#ffffff;">As</text><text styleclass="" style="font-family:Consolas; font-size:11pt; color:#000000; background-color:#ffffff;">&#32;</text><text styleclass="" style="font-family:Consolas; font-size:11pt; color:#0000ff; background-color:#ffffff;">Void</text></para>
    <para styleclass="" style="text-align:left; text-indent:0px; margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:26px; line-height:1.00; background-color:transparent; white-space:normal; page-break-inside:auto; page-break-after:auto; border:none; tabstops:none;"><text styleclass="" style="font-family:Consolas; font-size:11pt; color:#000000; background-color:#ffffff;"> &#160; &#160;</text><text styleclass="" style="font-family:Consolas; font-size:11pt; color:#0000ff; background-color:#ffffff;">Local</text><text styleclass="" style="font-family:Consolas; font-size:11pt; color:#000000; background-color:#ffffff;"> oForm </text><text styleclass="" style="font-family:Consolas; font-size:11pt; color:#0000ff; background-color:#ffffff;">As</text><text styleclass="" style="font-family:Consolas; font-size:11pt; color:#000000; background-color:#ffffff;"> Form</text></para>
    <para styleclass="" style="text-align:left; text-indent:0px; margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:26px; line-height:1.00; background-color:transparent; white-space:normal; page-break-inside:auto; page-break-after:auto; border:none; tabstops:none;"><text styleclass="" style="font-family:Consolas; font-size:11pt; color:#000000; background-color:#ffffff;"> &#160; &#160;oForm = Form{}</text></para>
    <para styleclass="" style="text-align:left; text-indent:0px; margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:26px; line-height:1.00; background-color:transparent; white-space:normal; page-break-inside:auto; page-break-after:auto; border:none; tabstops:none;"><text styleclass="" style="font-family:Consolas; font-size:11pt; color:#000000; background-color:#ffffff;"> &#160; &#160;oForm.Text = </text><text styleclass="" style="font-family:Consolas; font-size:11pt; color:#a31515; background-color:#ffffff;">&quot;点击窗体激活匿名方法&quot;</text></para>
    <para styleclass="" style="text-align:left; text-indent:0px; margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:26px; line-height:1.00; background-color:transparent; white-space:normal; page-break-inside:auto; page-break-after:auto; border:none; tabstops:none;"><text styleclass="" style="font-family:Consolas; font-size:11pt; color:#000000; background-color:#ffffff;"> &#160; &#160;oForm.Click += </text><text styleclass="" style="font-family:Consolas; font-size:11pt; color:#0000ff; background-color:#ffffff;">Delegate</text><text styleclass="" style="font-family:Consolas; font-size:11pt; color:#000000; background-color:#ffffff;">(o </text><text styleclass="" style="font-family:Consolas; font-size:11pt; color:#0000ff; background-color:#ffffff;">As</text><text styleclass="" style="font-family:Consolas; font-size:11pt; color:#000000; background-color:#ffffff;"> System.Object, e </text><text styleclass="" style="font-family:Consolas; font-size:11pt; color:#0000ff; background-color:#ffffff;">As</text><text styleclass="" style="font-family:Consolas; font-size:11pt; color:#000000; background-color:#ffffff;"> System.EventArgs ) { &#160;</text></para>
    <para styleclass="" style="text-align:left; text-indent:0px; margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:26px; line-height:1.00; background-color:transparent; white-space:normal; page-break-inside:auto; page-break-after:auto; border:none; tabstops:none;"><text styleclass="" style="font-family:Consolas; font-size:11pt; color:#000000; background-color:#ffffff;"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;System.Windows.Forms.MessageBox.Show(</text><text styleclass="" style="font-family:Consolas; font-size:11pt; color:#a31515; background-color:#ffffff;">&quot;Click 1!&quot;</text><text styleclass="" style="font-family:Consolas; font-size:11pt; color:#000000; background-color:#ffffff;">) &#160; &#160;</text></para>
    <para styleclass="" style="text-align:left; text-indent:0px; margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:26px; line-height:1.00; background-color:transparent; white-space:normal; page-break-inside:auto; page-break-after:auto; border:none; tabstops:none;"><text styleclass="" style="font-family:Consolas; font-size:11pt; color:#000000; background-color:#ffffff;"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;System.Windows.Forms.MessageBox.Show(</text><text styleclass="" style="font-family:Consolas; font-size:11pt; color:#a31515; background-color:#ffffff;">&quot;Click 2!&quot;</text><text styleclass="" style="font-family:Consolas; font-size:11pt; color:#000000; background-color:#ffffff;">) &#160; </text></para>
    <para styleclass="" style="text-align:left; text-indent:0px; margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:26px; line-height:1.00; background-color:transparent; white-space:normal; page-break-inside:auto; page-break-after:auto; border:none; tabstops:none;"><text styleclass="" style="font-family:Consolas; font-size:11pt; color:#000000; background-color:#ffffff;"> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;} &#160; </text></para>
    <para styleclass="" style="text-align:left; text-indent:0px; margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:26px; line-height:1.00; background-color:transparent; white-space:normal; page-break-inside:auto; page-break-after:auto; border:none; tabstops:none;"><text styleclass="" style="font-family:Consolas; font-size:11pt; color:#000000; background-color:#ffffff;"> &#160; &#160;oForm.ShowDialog()</text></para>
    <para styleclass="" style="text-align:left; text-indent:0px; margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:26px; line-height:1.00; background-color:transparent; white-space:normal; page-break-inside:auto; page-break-after:auto; border:none; tabstops:none;"><text styleclass="" style="font-family:Consolas; font-size:11pt; color:#000000; background-color:#ffffff;"> &#160; &#160;</text><text styleclass="" style="font-family:Consolas; font-size:11pt; color:#0000ff; background-color:#ffffff;">Return</text><text styleclass="" style="font-family:Consolas; font-size:11pt; color:#000000; background-color:#ffffff;">&#32;</text></para>
    <para styleclass="" style="text-align:left; text-indent:0px; margin-top:0px; margin-right:0px; margin-bottom:0px; margin-left:26px; line-height:1.00; background-color:transparent; white-space:normal; page-break-inside:auto; page-break-after:auto; border:none; tabstops:none;"><text styleclass="" style="font-family:Consolas; font-size:11pt; color:#0000ff; background-color:#ffffff;">End</text><text styleclass="" style="font-family:Consolas; font-size:11pt; color:#000000; background-color:#ffffff;">&#32;</text><text styleclass="" style="font-family:Consolas; font-size:11pt; color:#0000ff; background-color:#ffffff;">Function</text></para>
  </body>
</topic>
